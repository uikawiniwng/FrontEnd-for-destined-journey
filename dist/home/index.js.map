{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.28_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/src/home/services/worldbookload&update.ts","src://tavern_helper_template/src/home/services/CorePage.ts","webpack://tavern_helper_template/./src/home/components/CorePage.vue?06ef","webpack://tavern_helper_template/src/home/components/CorePage.vue?3e20","src://tavern_helper_template/src/home/services/DLCManagement.ts","webpack://tavern_helper_template/./src/home/components/DLCManagementPage.vue?3058","webpack://tavern_helper_template/src/home/components/DLCManagementPage.vue?e24a","src://tavern_helper_template/src/home/services/envCheck.ts","webpack://tavern_helper_template/./src/home/components/EnvCheckPage.vue?28d2","webpack://tavern_helper_template/src/home/components/EnvCheckPage.vue?a0e0","webpack://tavern_helper_template/./src/home/components/ShowcaseSection.vue?8e3c","webpack://tavern_helper_template/src/home/components/ShowcaseSection.vue?11ed","src://tavern_helper_template/src/home/services/outputMethod.ts","src://tavern_helper_template/src/home/services/StartPage.ts","webpack://tavern_helper_template/./src/home/components/StartPage.vue?a88c","webpack://tavern_helper_template/src/home/components/StartPage.vue?6e59","webpack://tavern_helper_template/./src/home/App.vue?ded1","webpack://tavern_helper_template/src/home/App.vue?60c0","src://tavern_helper_template/src/home/index.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","//获取世界书名字\nexport function getWorldBookName() {\n  const bookInfo = window.top?.TavernHelper.getCharWorldbookNames('current');\n  const BookName = bookInfo ? bookInfo.primary : null;\n  return BookName;\n}\n//获取条目\nexport async function getWorldbookEntries(bookName: string | null) {\n  if (!bookName) {\n    return;\n  }\n  const worldbook = await window.top?.TavernHelper.getWorldbook(bookName);\n  if (!worldbook) {\n    return;\n  }\n  return worldbook.map((entry: { name: string; enabled: boolean }) => ({\n    name: entry.name,\n    enabled: entry.enabled,\n  }));\n}\n//使用正则筛选条目\nexport async function getFilteredEntries(pattern: RegExp, bookName: string | null) {\n  const worldbook = await getWorldbookEntries(bookName);\n  if (!worldbook || worldbook.length === 0) {\n    return [];\n  }\n  return worldbook\n    .filter((entry: { name: string }) => pattern.test(entry.name))\n    .map((entry: { name: any; enabled: any }) => ({\n      name: entry.name,\n      enabled: entry.enabled,\n    }));\n}\n/**\n * 更新世界书条目的启用状态\n *\n * @param entries 修改后的条目列表，包含 name 和 enabled 属性\n * @throws 如果没有绑定世界书或世界书不存在，将会抛出错误\n *\n * @example\n * // 更新世界书\n * await updateWorldBook(entries);\n */\nexport async function updateWorldBook(\n  entries: Array<{ name: string; enabled: boolean }>,\n  bookName: string,\n): Promise<void> {\n  if (!bookName) {\n    return;\n  }\n  if (!bookName) {\n    throw new Error('No worldbook bound to current character');\n  }\n\n  const enabledMap = new Map(entries.map(e => [e.name, e.enabled]));\n\n  await window.top?.TavernHelper.updateWorldbookWith(bookName, worldbook => {\n    return worldbook.map(entry => {\n      const newEnabled = enabledMap.get(entry.name);\n      if (newEnabled !== undefined) {\n        return { ...entry, enabled: newEnabled };\n      }\n      return entry;\n    });\n  });\n}\n","import JSON5 from 'json5';\n\nimport { getFilteredEntries, getWorldBookName, updateWorldBook } from './worldbookload&update';\n\n// 未分类的默认tab名称\nexport const UNCATEGORIZED_TAB = '这是什么杯';\n\n// 固定的特别推荐tab名称\nexport const SPECIAL_RECOMMEND_TAB = '特别推荐';\n\n// 特别推荐核心配置类型\nexport interface SpecialRecommendConfig {\n  note: string;\n}\n\n// 特别推荐最大显示数量\nexport const MAX_SPECIAL_RECOMMEND_COUNT = 3;\n\n// 特别推荐核心的完整信息（包含可用性状态）\nexport interface SpecialRecommendCore {\n  value: string;\n  label: string;\n  author: string;\n  specialNote: string;\n  available: boolean; // 核心是否在核心列表中存在\n}\n\n// 核心选项类型\nexport interface CoreOption {\n  value: string;\n  label: string;\n  author: string; // 作者信息，从括号内提取\n  enabled: boolean;\n  tabs: string[]; // 改为数组，支持一个核心属于多个分组\n  note: string; // 从排行榜获取的note\n  specialNote: string; // 特别推荐的硬编码note\n}\n\n// 核心条目匹配模式 - 匹配以\"命定系统-\"开头的条目\nconst CORE_PATTERN = /^命定系统-/;\n\n// 提取作者信息的正则 - 匹配末尾括号内容\nconst AUTHOR_PATTERN = /\\(([^)]*)\\)$/;\n\n/**\n * 核心状态初始值\n */\nexport const initialCoreState = {\n  coreOptions: [] as CoreOption[],\n  localCoreSelections: new Map<string, boolean>(),\n  tabs: [] as string[],\n  activeTab: '',\n};\n\n/**\n * 核心分类数据类型\n */\ntype CoreClassificationData = Record<string, Record<string, { note?: string }>>;\n\n/**\n * 缓存的排行榜数据\n */\nlet cachedRankings: CoreClassificationData | null = null;\n\n/**\n * 缓存的特别推荐核心数据\n */\nlet cachedSpecialRecommendCores: Record<string, SpecialRecommendConfig> | null = null;\n\n/**\n * 数据基础路径 - CDN 部署环境\n * 使用版本号替代 @latest 以确保缓存正确更新\n */\nconst DATA_BASE_PATH = `https://testingcf.jsdelivr.net/gh/The-poem-of-destiny/FrontEnd-for-destined-journey@${__APP_VERSION__}/public/assets/data`;\n\n/**\n * 从远程加载核心分类数据\n * 使用 JSON5 解析，支持注释和更灵活的格式\n */\nasync function loadCoreClassification(): Promise<CoreClassificationData> {\n  if (cachedRankings !== null) {\n    return cachedRankings;\n  }\n\n  try {\n    const response = await fetch(`${DATA_BASE_PATH}/coreClassification.json`);\n    if (!response.ok) {\n      console.log('未找到核心分类数据文件 (coreClassification.json)');\n      return {};\n    }\n\n    const text = await response.text();\n    const data = JSON5.parse(text) as CoreClassificationData;\n    console.log('成功加载核心分类数据');\n    cachedRankings = data;\n    return data;\n  } catch (error) {\n    console.log('未找到核心分类数据或格式错误:', error);\n    return {};\n  }\n}\n\n/**\n * 获取排行榜数据（同步版本，使用缓存）\n */\nfunction getRankings(): CoreClassificationData | undefined {\n  return cachedRankings ?? undefined;\n}\n\n/**\n * 从远程加载特别推荐核心数据\n * 使用 JSON5 解析，支持注释和更灵活的格式\n */\nexport async function loadSpecialRecommendCores(): Promise<Record<string, SpecialRecommendConfig>> {\n  if (cachedSpecialRecommendCores !== null) {\n    return cachedSpecialRecommendCores;\n  }\n\n  try {\n    const response = await fetch(`${DATA_BASE_PATH}/SPECIAL_RECOMMEND_CORES.json`);\n    if (!response.ok) {\n      console.log('未找到特别推荐核心数据文件 (SPECIAL_RECOMMEND_CORES.json)');\n      return {};\n    }\n\n    const text = await response.text();\n    const data = JSON5.parse(text) as Record<string, SpecialRecommendConfig>;\n    console.log('成功加载特别推荐核心数据');\n    cachedSpecialRecommendCores = data;\n    return data;\n  } catch (error) {\n    console.log('未找到特别推荐核心数据或格式错误:', error);\n    return {};\n  }\n}\n\n/**\n * 从排行榜数据中动态获取所有tab名称\n */\nexport async function getTabsFromRankings(): Promise<string[]> {\n  const Rankings = await loadCoreClassification();\n  if (!Rankings || typeof Rankings !== 'object') {\n    return [SPECIAL_RECOMMEND_TAB, UNCATEGORIZED_TAB];\n  }\n\n  // 获取排行榜中的所有键作为tab\n  const dynamicTabs = Object.keys(Rankings).filter(\n    key => Rankings[key] && typeof Rankings[key] === 'object',\n  );\n\n  // 如果没有动态tab，返回默认的tabs\n  if (dynamicTabs.length === 0) {\n    return [SPECIAL_RECOMMEND_TAB, UNCATEGORIZED_TAB];\n  }\n\n  // \"特别推荐\"固定在第一位，\"这是什么杯\"作为未分类的tab放在最后\n  return [SPECIAL_RECOMMEND_TAB, ...dynamicTabs, UNCATEGORIZED_TAB];\n}\n\n/**\n * 根据核心label查找其所属的所有tab分类和note\n * 一个核心可以同时属于多个分组\n * 注意：特别推荐通过独立逻辑处理，不在此函数中添加\n * @param label 核心标签（不含前缀和作者）\n * @param allTabs 所有tab列表\n */\nexport function getCoreRanking(label: string, allTabs: string[]): { tabs: string[]; note: string } {\n  const Rankings = getRankings();\n  const matchedTabs: string[] = [];\n  let note = '';\n\n  if (Rankings && typeof Rankings === 'object') {\n    // 遍历所有tab查找核心（排除\"这是什么杯\"和\"特别推荐\"）\n    for (const tabName of allTabs) {\n      if (tabName === UNCATEGORIZED_TAB || tabName === SPECIAL_RECOMMEND_TAB) continue;\n\n      const tabData = Rankings[tabName];\n      if (tabData && typeof tabData === 'object') {\n        // 检查核心名称是否在此tab中\n        if (label in tabData) {\n          matchedTabs.push(tabName);\n          // 使用第一个匹配的note\n          if (!note && tabData[label]?.note) {\n            note = tabData[label].note;\n          }\n        }\n      }\n    }\n  }\n\n  // 未找到任何分组则归入\"这是什么杯\"\n  if (matchedTabs.length === 0) {\n    return { tabs: [UNCATEGORIZED_TAB], note: '' };\n  }\n\n  return { tabs: matchedTabs, note };\n}\n\n/**\n * 生成特别推荐核心列表（包含可用性信息）\n * 返回所有推荐核心，标记哪些在核心列表中存在（可用），最多返回 MAX_SPECIAL_RECOMMEND_COUNT 个\n * @param specialRecommendCores 特别推荐核心配置\n * @param existingCoreValues 当前存在的核心值集合\n */\nexport function generateSpecialRecommendCores(\n  specialRecommendCores: Record<string, SpecialRecommendConfig>,\n  existingCoreValues: Set<string>,\n): SpecialRecommendCore[] {\n  const result: SpecialRecommendCore[] = [];\n  let count = 0;\n\n  for (const [coreValue, config] of Object.entries(specialRecommendCores)) {\n    if (count >= MAX_SPECIAL_RECOMMEND_COUNT) {\n      break;\n    }\n\n    // 去掉\"命定系统-\"前缀\n    const nameWithoutPrefix = coreValue.replace(/^命定系统-/, '');\n    // 提取作者信息（括号内容）\n    const authorMatch = nameWithoutPrefix.match(/\\(([^)]*)\\)$/);\n    const author = authorMatch ? authorMatch[1] : '';\n    // 去掉末尾括号内容作为显示标签\n    const label = nameWithoutPrefix.replace(/\\(([^)]*)\\)$/, '');\n\n    result.push({\n      value: coreValue,\n      label,\n      author,\n      specialNote: config.note,\n      available: existingCoreValues.has(coreValue),\n    });\n    count++;\n  }\n\n  return result;\n}\n\n/**\n * 获取指定tab下的核心列表\n * 核心可以同时属于多个tab\n */\nexport function getCoresForTab(coreOptions: CoreOption[], tab: string): CoreOption[] {\n  return coreOptions.filter(core => core.tabs.includes(tab));\n}\n\n/**\n * 获取当前选中的核心\n */\nexport function getSelectedCore(localCoreSelections: Map<string, boolean>): string | null {\n  for (const [name, enabled] of localCoreSelections) {\n    if (enabled) return name;\n  }\n  return null;\n}\n\n/**\n * 加载核心列表\n * @param specialRecommendCores 特别推荐核心列表（从外部传入）\n */\nexport async function loadCoreOptions(\n  specialRecommendCores: Record<string, SpecialRecommendConfig> = {},\n): Promise<{\n  coreOptions: CoreOption[];\n  localCoreSelections: Map<string, boolean>;\n  tabs: string[];\n  activeTab: string;\n  bookName: string | null;\n  specialRecommendCoreList: SpecialRecommendCore[];\n}> {\n  // 动态获取tabs（需要先加载核心分类数据）\n  const tabs = await getTabsFromRankings();\n  const bookName = getWorldBookName();\n  const entries = await getFilteredEntries(CORE_PATTERN, bookName);\n\n  // 构建存在的核心值集合\n  const existingCoreValues = new Set(entries.map((entry: { name: string }) => entry.name));\n\n  // 生成特别推荐核心列表（包含可用性信息，最多3个）\n  const specialRecommendCoreList = generateSpecialRecommendCores(\n    specialRecommendCores,\n    existingCoreValues,\n  );\n\n  // 创建可用的特别推荐核心值集合（用于后续判断）\n  const availableSpecialCores = new Set(\n    specialRecommendCoreList.filter(core => core.available).map(core => core.value),\n  );\n\n  const coreOptions = entries.map((entry: { name: string; enabled: boolean }) => {\n    // 去掉\"命定系统-\"前缀\n    const nameWithoutPrefix = entry.name.replace(CORE_PATTERN, '');\n    // 提取作者信息（括号内容）\n    const authorMatch = nameWithoutPrefix.match(AUTHOR_PATTERN);\n    const author = authorMatch ? authorMatch[1] : '';\n    // 去掉末尾括号内容作为显示标签\n    const label = nameWithoutPrefix.replace(AUTHOR_PATTERN, '');\n    const ranking = getCoreRanking(label, tabs);\n\n    // 独立处理特别推荐：检查核心是否在可用的特别推荐列表中\n    const coreTabs = [...ranking.tabs];\n    let specialNote = '';\n    if (availableSpecialCores.has(entry.name)) {\n      coreTabs.unshift(SPECIAL_RECOMMEND_TAB); // 特别推荐放在最前面\n      const recommendCore = specialRecommendCoreList.find(c => c.value === entry.name);\n      specialNote = recommendCore?.specialNote || '';\n    }\n\n    return {\n      value: entry.name,\n      label,\n      author,\n      enabled: entry.enabled,\n      tabs: coreTabs,\n      note: ranking.note,\n      specialNote,\n    };\n  });\n\n  // 初始化本地选择列表（从世界书的原始状态复制）\n  const localCoreSelections = new Map(coreOptions.map(core => [core.value, core.enabled]));\n\n  // 固定显示第一个tab（特别推荐），取消自动切换到已启用核心的tab\n  const activeTab = tabs[0] || SPECIAL_RECOMMEND_TAB;\n\n  return {\n    coreOptions,\n    localCoreSelections,\n    tabs,\n    activeTab,\n    bookName,\n    specialRecommendCoreList,\n  };\n}\n\n/**\n * 选择核心（仅更新本地状态，返回新的选择Map）\n */\nexport function selectCore(\n  localCoreSelections: Map<string, boolean>,\n  coreValue: string,\n): Map<string, boolean> {\n  const currentSelected = getSelectedCore(localCoreSelections);\n  if (currentSelected === coreValue) {\n    return localCoreSelections; // 已选中，无需操作\n  }\n\n  // 创建新的Map，禁用其他核心，启用选中的核心\n  const newSelections = new Map<string, boolean>();\n  for (const [name] of localCoreSelections) {\n    newSelections.set(name, name === coreValue);\n  }\n  return newSelections;\n}\n\n/**\n * 检查本地选择是否与原始状态有变化\n */\nexport function hasChanges(\n  coreOptions: CoreOption[],\n  localCoreSelections: Map<string, boolean>,\n): boolean {\n  for (const core of coreOptions) {\n    const localEnabled = localCoreSelections.get(core.value) ?? false;\n    if (localEnabled !== core.enabled) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * 保存核心选择到世界书\n * @param coreOptions 核心选项列表\n * @param localCoreSelections 本地选择状态\n * @param bookName 世界书名称\n * @returns 更新后的核心选项列表\n */\nexport async function saveChanges(\n  coreOptions: CoreOption[],\n  localCoreSelections: Map<string, boolean>,\n  bookName: string,\n): Promise<CoreOption[]> {\n  if (!hasChanges(coreOptions, localCoreSelections)) {\n    return coreOptions;\n  }\n\n  // 构建更新列表\n  const updatedEntries = Array.from(localCoreSelections).map(([name, enabled]) => ({\n    name,\n    enabled,\n  }));\n\n  await updateWorldBook(updatedEntries, bookName);\n\n  // 返回更新后的核心选项列表\n  return coreOptions.map(core => ({\n    ...core,\n    enabled: localCoreSelections.get(core.value) ?? false,\n  }));\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, unref as _unref, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = { class: \"core-page\" };\nconst _hoisted_2 = { class: \"control-panel-container\" };\nconst _hoisted_3 = { class: \"tab-navigation\" };\nconst _hoisted_4 = [\"disabled\"];\nconst _hoisted_5 = { class: \"tab-buttons-container\" };\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = { class: \"tab-label\" };\nconst _hoisted_8 = {\n    key: 0,\n    class: \"tab-count\"\n};\nconst _hoisted_9 = [\"disabled\"];\nconst _hoisted_10 = [\"disabled\"];\nconst _hoisted_11 = { class: \"tab-content\" };\nconst _hoisted_12 = { class: \"control-group\" };\nconst _hoisted_13 = {\n    key: 0,\n    class: \"loading-text\"\n};\nconst _hoisted_14 = {\n    key: 1,\n    class: \"empty-text\"\n};\nconst _hoisted_15 = { class: \"special-recommend-container\" };\nconst _hoisted_16 = { class: \"special-recommend-cards\" };\nconst _hoisted_17 = [\"onClick\"];\nconst _hoisted_18 = {\n    key: 0,\n    class: \"card-overlay\"\n};\nconst _hoisted_19 = { class: \"card-content\" };\nconst _hoisted_20 = { class: \"card-label\" };\nconst _hoisted_21 = {\n    key: 0,\n    class: \"card-author\"\n};\nconst _hoisted_22 = { class: \"card-note\" };\nconst _hoisted_23 = { class: \"control-buttons\" };\nconst _hoisted_24 = [\"onClick\"];\nconst _hoisted_25 = {\n    key: 0,\n    class: \"core-author\"\n};\nconst _hoisted_26 = {\n    key: 1,\n    class: \"core-note\"\n};\nconst _hoisted_27 = { class: \"step-footer\" };\nconst _hoisted_28 = [\"disabled\"];\nconst _hoisted_29 = [\"disabled\"];\nimport { computed, onMounted, ref, watch } from 'vue';\nimport { getCoresForTab as getCoresForTabService, getSelectedCore, initialCoreState, loadCoreOptions as loadCoreOptionsService, loadSpecialRecommendCores, saveChanges as saveChangesService, selectCore, SPECIAL_RECOMMEND_TAB, } from '../services/CorePage';\nconst maxVisibleTabs = 4;\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CorePage',\n    emits: [\"prev\", \"next\"],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const isLoading = ref(false);\n        const isSaving = ref(false);\n        const tabs = ref([...initialCoreState.tabs]);\n        const activeTab = ref(initialCoreState.activeTab);\n        const coreOptions = ref([...initialCoreState.coreOptions]);\n        const localCoreSelections = ref(new Map(initialCoreState.localCoreSelections));\n        const bookName = ref(null);\n        const specialRecommendCoreList = ref([]);\n        // Tab 分页相关\n        const tabStartIndex = ref(0);\n        const selectedCore = computed(() => getSelectedCore(localCoreSelections.value));\n        // 当前是否在特别推荐tab\n        const isSpecialRecommendTab = computed(() => activeTab.value === SPECIAL_RECOMMEND_TAB);\n        // 是否显示箭头\n        const showArrows = computed(() => tabs.value.length > maxVisibleTabs);\n        // 当前可见的 tabs\n        const visibleTabs = computed(() => {\n            if (!showArrows.value) {\n                return tabs.value;\n            }\n            return tabs.value.slice(tabStartIndex.value, tabStartIndex.value + maxVisibleTabs);\n        });\n        // 切换到上一批 tabs\n        function handlePrevTabs() {\n            if (tabStartIndex.value > 0) {\n                tabStartIndex.value = Math.max(0, tabStartIndex.value - maxVisibleTabs);\n            }\n        }\n        // 切换到下一批 tabs\n        function handleNextTabs() {\n            if (tabStartIndex.value + maxVisibleTabs < tabs.value.length) {\n                tabStartIndex.value = Math.min(tabs.value.length - maxVisibleTabs, tabStartIndex.value + maxVisibleTabs);\n            }\n        }\n        // 当 activeTab 改变时，确保它在可见范围内\n        watch(activeTab, newTab => {\n            const tabIndex = tabs.value.indexOf(newTab);\n            if (tabIndex !== -1 && showArrows.value) {\n                if (tabIndex < tabStartIndex.value) {\n                    tabStartIndex.value = tabIndex;\n                }\n                else if (tabIndex >= tabStartIndex.value + maxVisibleTabs) {\n                    tabStartIndex.value = tabIndex - maxVisibleTabs + 1;\n                }\n            }\n        });\n        function getCoresForTab(tab) {\n            return getCoresForTabService(coreOptions.value, tab);\n        }\n        async function loadCoreOptions() {\n            isLoading.value = true;\n            try {\n                // 从远程加载特别推荐核心数据\n                const specialRecommendCoresData = await loadSpecialRecommendCores();\n                const result = await loadCoreOptionsService(specialRecommendCoresData);\n                tabs.value = result.tabs;\n                coreOptions.value = result.coreOptions;\n                localCoreSelections.value = result.localCoreSelections;\n                activeTab.value = result.activeTab;\n                bookName.value = result.bookName;\n                specialRecommendCoreList.value = result.specialRecommendCoreList;\n            }\n            catch (error) {\n                console.error('加载核心列表失败:', error);\n                tabs.value = [];\n                coreOptions.value = [];\n                localCoreSelections.value = new Map();\n                bookName.value = null;\n                specialRecommendCoreList.value = [];\n            }\n            finally {\n                isLoading.value = false;\n            }\n        }\n        async function handleRefresh() {\n            await loadCoreOptions();\n        }\n        function handleSelectCore(coreValue) {\n            localCoreSelections.value = selectCore(localCoreSelections.value, coreValue);\n        }\n        /**\n         * 点击下一步：根据本地列表更新世界书后跳转\n         */\n        async function handleNext() {\n            isSaving.value = true;\n            try {\n                if (bookName.value) {\n                    coreOptions.value = await saveChangesService(coreOptions.value, localCoreSelections.value, bookName.value);\n                }\n            }\n            catch (error) {\n                console.error('保存核心选择失败:', error);\n            }\n            finally {\n                isSaving.value = false;\n            }\n            emit('next');\n        }\n        // 组件挂载时加载核心列表\n        onMounted(() => {\n            loadCoreOptions();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[5] || (_cache[5] = _createElementVNode(\"h2\", { class: \"main-title\" }, \"核心选择\", -1 /* CACHED */)),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createCommentVNode(\" Tab 导航 \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (showArrows.value)\n                            ? (_openBlock(), _createElementBlock(\"button\", {\n                                key: 0,\n                                class: \"arrow-button\",\n                                disabled: tabStartIndex.value === 0,\n                                title: \"上一页\",\n                                onClick: handlePrevTabs\n                            }, [...(_cache[1] || (_cache[1] = [\n                                    _createElementVNode(\"span\", null, \"‹\", -1 /* CACHED */)\n                                ]))], 8 /* PROPS */, _hoisted_4))\n                            : _createCommentVNode(\"v-if\", true),\n                        _createElementVNode(\"div\", _hoisted_5, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(visibleTabs.value, (tab) => {\n                                return (_openBlock(), _createElementBlock(\"button\", {\n                                    key: tab,\n                                    class: _normalizeClass([\"tab-button\", {\n                                            active: activeTab.value === tab,\n                                            'special-recommend-tab': tab === _unref(SPECIAL_RECOMMEND_TAB),\n                                        }]),\n                                    onClick: ($event) => (activeTab.value = tab)\n                                }, [\n                                    _createElementVNode(\"span\", _hoisted_7, _toDisplayString(tab), 1 /* TEXT */),\n                                    (tab !== _unref(SPECIAL_RECOMMEND_TAB))\n                                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_8, \"(\" + _toDisplayString(getCoresForTab(tab).length) + \")\", 1 /* TEXT */))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ], 10 /* CLASS, PROPS */, _hoisted_6));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]),\n                        (showArrows.value)\n                            ? (_openBlock(), _createElementBlock(\"button\", {\n                                key: 1,\n                                class: \"arrow-button\",\n                                disabled: tabStartIndex.value + maxVisibleTabs >= tabs.value.length,\n                                title: \"下一页\",\n                                onClick: handleNextTabs\n                            }, [...(_cache[2] || (_cache[2] = [\n                                    _createElementVNode(\"span\", null, \"›\", -1 /* CACHED */)\n                                ]))], 8 /* PROPS */, _hoisted_9))\n                            : _createCommentVNode(\"v-if\", true),\n                        _createElementVNode(\"button\", {\n                            class: \"refresh-button\",\n                            disabled: isLoading.value,\n                            title: \"刷新核心列表\",\n                            onClick: handleRefresh\n                        }, [\n                            _createElementVNode(\"span\", {\n                                class: _normalizeClass({ 'is-spinning': isLoading.value })\n                            }, \"⟳\", 2 /* CLASS */)\n                        ], 8 /* PROPS */, _hoisted_10)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        _createElementVNode(\"div\", _hoisted_12, [\n                            (isLoading.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, \"正在加载核心列表...\"))\n                                : (coreOptions.value.length === 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, \"未找到可用的核心\"))\n                                    : (isSpecialRecommendTab.value)\n                                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n                                            _createCommentVNode(\" 特别推荐显示 - 特殊卡片布局 \"),\n                                            _createElementVNode(\"div\", _hoisted_15, [\n                                                _cache[3] || (_cache[3] = _createStaticVNode(\"<div class=\\\"recommend-hero-section\\\" data-v-955173c2><div class=\\\"hero-icon\\\" data-v-955173c2>✦</div><div class=\\\"hero-content\\\" data-v-955173c2><h3 class=\\\"hero-title\\\" data-v-955173c2>本周精选</h3><p class=\\\"hero-subtitle\\\" data-v-955173c2>由<s data-v-955173c2>社区</s>与编辑共同甄选的优质(?)核心</p></div><div class=\\\"hero-divider\\\" data-v-955173c2></div></div>\", 1)),\n                                                _createElementVNode(\"div\", _hoisted_16, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(specialRecommendCoreList.value, (recommendCore) => {\n                                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                                            key: recommendCore.value,\n                                                            class: _normalizeClass([\"special-recommend-card\", {\n                                                                    unavailable: !recommendCore.available,\n                                                                    selected: selectedCore.value === recommendCore.value,\n                                                                }]),\n                                                            onClick: ($event) => (recommendCore.available && handleSelectCore(recommendCore.value))\n                                                        }, [\n                                                            (!recommendCore.available)\n                                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18))\n                                                                : _createCommentVNode(\"v-if\", true),\n                                                            _createElementVNode(\"div\", _hoisted_19, [\n                                                                _createElementVNode(\"div\", _hoisted_20, _toDisplayString(recommendCore.label), 1 /* TEXT */),\n                                                                (recommendCore.author)\n                                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, _toDisplayString(recommendCore.author), 1 /* TEXT */))\n                                                                    : _createCommentVNode(\"v-if\", true),\n                                                                _createElementVNode(\"div\", _hoisted_22, [\n                                                                    (!recommendCore.available)\n                                                                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                                                            _createTextVNode(\"不可用\")\n                                                                        ], 64 /* STABLE_FRAGMENT */))\n                                                                        : (recommendCore.specialNote)\n                                                                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                                                                _createTextVNode(_toDisplayString(recommendCore.specialNote), 1 /* TEXT */)\n                                                                            ], 64 /* STABLE_FRAGMENT */))\n                                                                            : _createCommentVNode(\"v-if\", true)\n                                                                ])\n                                                            ])\n                                                        ], 10 /* CLASS, PROPS */, _hoisted_17));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ])\n                                            ])\n                                        ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                                        : (_openBlock(), _createElementBlock(_Fragment, { key: 3 }, [\n                                            _createCommentVNode(\" 普通核心显示 \"),\n                                            _createElementVNode(\"div\", _hoisted_23, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(getCoresForTab(activeTab.value), (core) => {\n                                                    return (_openBlock(), _createElementBlock(\"div\", {\n                                                        key: core.value,\n                                                        class: \"control-item-wrapper\"\n                                                    }, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: _normalizeClass([\"control-button\", { selected: selectedCore.value === core.value }]),\n                                                            onClick: ($event) => (handleSelectCore(core.value))\n                                                        }, _toDisplayString(core.label), 11 /* TEXT, CLASS, PROPS */, _hoisted_24),\n                                                        (core.author)\n                                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_25, _toDisplayString(core.author), 1 /* TEXT */))\n                                                            : _createCommentVNode(\"v-if\", true),\n                                                        (core.note)\n                                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_26, _toDisplayString(core.note), 1 /* TEXT */))\n                                                            : _createCommentVNode(\"v-if\", true)\n                                                    ]));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                        ])\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_27, [\n                    _createElementVNode(\"button\", {\n                        class: \"nav-button\",\n                        disabled: isSaving.value,\n                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('prev')))\n                    }, [...(_cache[4] || (_cache[4] = [\n                            _createElementVNode(\"span\", null, \"上一步\", -1 /* CACHED */)\n                        ]))], 8 /* PROPS */, _hoisted_28),\n                    _createElementVNode(\"button\", {\n                        class: \"nav-button\",\n                        disabled: !selectedCore.value || isLoading.value || isSaving.value,\n                        onClick: handleNext\n                    }, [\n                        _createElementVNode(\"span\", null, _toDisplayString(isSaving.value ? '保存中...' : '下一步'), 1 /* TEXT */)\n                    ], 8 /* PROPS */, _hoisted_29)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CorePage.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CorePage.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CorePage.vue?vue&type=style&index=0&id=955173c2&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.28_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-955173c2\"]])\n\nexport default __exports__","import { getFilteredEntries, getWorldBookName, updateWorldBook } from './worldbookload&update';\n\n// ========================\n// 排序相关函数\n// ========================\n\n/**\n * 按拼音首字母排序比较函数\n * 中文按照拼音首字母排序，英文按照 a-z 排序\n * @param a 第一个字符串\n * @param b 第二个字符串\n * @returns 比较结果\n */\nfunction pinyinCompare(a: string, b: string): number {\n  return a.localeCompare(b, 'zh-CN', { sensitivity: 'base' });\n}\n\n/**\n * 对角色选项进行排序（按 label 的拼音首字母排序）\n * @param options 角色选项数组\n * @returns 排序后的角色选项数组\n */\nexport function sortCharacterOptions(options: CharacterOption[]): CharacterOption[] {\n  return [...options].sort((a, b) => pinyinCompare(a.label, b.label));\n}\n\n/**\n * 对事件选项进行排序（按 label 的拼音首字母排序）\n * @param options 事件选项数组\n * @returns 排序后的事件选项数组\n */\nexport function sortEventOptions(options: EventOption[]): EventOption[] {\n  return [...options].sort((a, b) => pinyinCompare(a.label, b.label));\n}\n\n/**\n * 对扩展选项进行排序（按 label 的拼音首字母排序）\n * @param options 扩展选项数组\n * @returns 排序后的扩展选项数组\n */\nexport function sortExtensionOptions(options: ExtensionOption[]): ExtensionOption[] {\n  return [...options].sort((a, b) => pinyinCompare(a.label, b.label));\n}\n\n// ========================\n// 角色相关类型和常量\n// ========================\n\n// 角色选项类型\nexport interface CharacterOption {\n  value: string; // 完整条目名称，如 \"[角色]name(A-原创角色)\"\n  label: string; // 显示名称，如 \"name\"\n  author: string; // 作者，如 \"A\"\n  info: string; // 其他信息，如 \"原创角色\"\n  enabled: boolean;\n}\n\n// 角色条目匹配模式 - 匹配以\"[角色]\"开头的条目\nconst CHARACTER_PATTERN = /^\\[角色\\]/;\n\n// 解析角色名和作者的正则 - 匹配 \"角色名(作者)\" 格式\nconst CHARACTER_NAME_PATTERN = /^(.+?)(?:\\(([^)]+)\\))?$/;\n\n/**\n * 角色状态初始值\n */\nexport const initialCharacterState = {\n  characterOptions: [] as CharacterOption[],\n  localCharacterSelections: new Map<string, boolean>(),\n};\n\n// ========================\n// 事件相关类型和常量\n// ========================\n\n// 事件条目类型（单个世界书条目）\nexport interface EventEntry {\n  name: string; // 完整条目名称，如 \"[事件][双子]双子星的咏叹调-本体\"\n  enabled: boolean;\n}\n\n// 事件选项类型（分组后的事件）\nexport interface EventOption {\n  eventKey: string; // 事件唯一标识，如 \"[事件][双子]\"\n  label: string; // 显示名称，如 \"双子\"\n  author: string; // 作者（从条目中提取）\n  info: string; // 其他信息（从条目中提取）\n  entries: EventEntry[]; // 该事件下的所有条目\n  enabled: boolean; // 事件是否启用（所有条目启用时为true）\n}\n\n// 事件条目匹配模式 - 匹配以\"[事件]\"开头的条目\nconst EVENT_PATTERN = /^\\[事件\\]/;\n\n// 提取事件名的正则 - 匹配 \"[事件][事件名]\" 格式\nconst EVENT_KEY_PATTERN = /^(\\[事件\\]\\[[^\\]]+\\])/;\n\n// 提取事件显示名称的正则 - 匹配 \"[事件名]\" 中的事件名\nconst EVENT_LABEL_PATTERN = /^\\[事件\\]\\[([^\\]]+)\\]/;\n\n// 提取作者的正则 - 匹配最后一个 \"(作者)\" 格式（事件和扩展通用）\nconst AUTHOR_PATTERN = /\\(([^)]+)\\)(?=[^()]*$)/;\n\n/**\n * 事件状态初始值\n */\nexport const initialEventState = {\n  eventOptions: [] as EventOption[],\n  localEventSelections: new Map<string, boolean>(),\n};\n\n// ========================\n// 扩展相关类型和常量\n// ========================\n\n// 扩展条目类型（单个世界书条目）\nexport interface ExtensionEntry {\n  name: string; // 完整条目名称，如 \"[扩展][无尽深渊地城扩展][!原版无尽深渊地城]无尽深渊地城-控制(Hilo)\"\n  enabled: boolean;\n}\n\n// 扩展选项类型（分组后的扩展）\nexport interface ExtensionOption {\n  extensionKey: string; // 扩展唯一标识，如 \"[扩展][无尽深渊地城扩展]\"\n  label: string; // 显示名称，如 \"无尽深渊地城扩展\"\n  author: string; // 作者，如 \"Hilo\"\n  info: string; // 其他信息\n  // 互斥目标数组 - [!xxx] 格式，开启时关闭包含 [xxx] 的扩展\n  exclusionTargets: string[];\n  // 替换目标数组 - [>xxx] 格式，开启时关闭包含 [xxx] 的条目，关闭时恢复\n  replacementTargets: string[];\n  // 前置需求数组 - [<xxx] 格式，需要 [xxx] 扩展处于开启状态\n  prerequisiteTargets: string[];\n  entries: ExtensionEntry[]; // 该扩展下的所有条目\n  enabled: boolean; // 扩展是否启用（所有条目启用时为true）\n}\n\n// 扩展条目匹配模式 - 匹配以\"[扩展]\"开头的条目\nconst EXTENSION_PATTERN = /^\\[扩展\\]/;\n\n// 提取扩展Key的正则 - 只匹配 \"[扩展][扩展名]\" 格式（不包含关系标记，以便同一扩展只需标记一次）\nconst EXTENSION_KEY_PATTERN = /^(\\[扩展\\]\\[[^\\]]+\\])/;\n\n// 提取扩展显示名称的正则 - 匹配 \"[扩展][扩展名]\" 中的扩展名\nconst EXTENSION_LABEL_PATTERN = /^\\[扩展\\]\\[([^\\]]+)\\]/;\n\n// 提取互斥目标的正则 - 匹配所有 \"[!互斥条目]\" 中的互斥条目名（全局匹配）\nconst EXTENSION_EXCLUSION_PATTERN = /\\[!([^\\]]+)\\]/g;\n\n// 提取替换目标的正则 - 匹配所有 \"[>替换条目]\" 中的替换条目名（全局匹配）\nconst EXTENSION_REPLACEMENT_PATTERN = /\\[>([^\\]]+)\\]/g;\n\n// 提取前置需求的正则 - 匹配所有 \"[<前置扩展]\" 中的前置扩展名（全局匹配）\nconst EXTENSION_PREREQUISITE_PATTERN = /\\[<([^\\]]+)\\]/g;\n\n/**\n * 扩展状态初始值\n */\nexport const initialExtensionState = {\n  extensionOptions: [] as ExtensionOption[],\n  localExtensionSelections: new Map<string, boolean>(),\n};\n\n/**\n * 解析角色条目名称，提取角色名、作者和其他信息\n * @param entryName 完整条目名称，如 \"[角色]薇薇拉(K1nn-原创角色)\"\n * @returns { label: string, author: string, info: string }\n */\nfunction parseCharacterName(entryName: string): { label: string; author: string; info: string } {\n  // 去掉\"[角色]\"前缀\n  const nameWithAuthor = entryName.replace(CHARACTER_PATTERN, '');\n\n  // 解析角色名和作者-信息\n  const match = nameWithAuthor.match(CHARACTER_NAME_PATTERN);\n  if (match) {\n    const authorInfo = match[2]?.trim() || '';\n    // 检查是否包含 \"-\" 分隔符\n    const dashIndex = authorInfo.indexOf('-');\n    if (dashIndex > 0) {\n      return {\n        label: match[1].trim(),\n        author: authorInfo.substring(0, dashIndex).trim(),\n        info: authorInfo.substring(dashIndex + 1).trim(),\n      };\n    }\n    return {\n      label: match[1].trim(),\n      author: authorInfo,\n      info: '',\n    };\n  }\n\n  return { label: nameWithAuthor, author: '', info: '' };\n}\n\n/**\n * 加载角色列表\n */\nexport async function loadCharacterOptions(): Promise<{\n  characterOptions: CharacterOption[];\n  localCharacterSelections: Map<string, boolean>;\n  bookName: string | null;\n}> {\n  const bookName = getWorldBookName();\n  const entries = await getFilteredEntries(CHARACTER_PATTERN, bookName);\n\n  const characterOptions = entries.map((entry: { name: string; enabled: boolean }) => {\n    const { label, author, info } = parseCharacterName(entry.name);\n    return {\n      value: entry.name,\n      label,\n      author,\n      info,\n      enabled: entry.enabled,\n    };\n  });\n\n  // 对角色选项进行排序（按拼音首字母）\n  const sortedCharacterOptions = sortCharacterOptions(characterOptions);\n\n  // 初始化本地选择列表（从世界书的原始状态复制）\n  const localCharacterSelections = new Map(\n    sortedCharacterOptions.map(char => [char.value, char.enabled]),\n  );\n\n  return { characterOptions: sortedCharacterOptions, localCharacterSelections, bookName };\n}\n\n/**\n * 切换角色启用状态（更新本地状态，返回新的选择Map）\n */\nexport function toggleCharacter(\n  localCharacterSelections: Map<string, boolean>,\n  characterValue: string,\n): Map<string, boolean> {\n  const newSelections = new Map(localCharacterSelections);\n  const currentEnabled = newSelections.get(characterValue) ?? false;\n  newSelections.set(characterValue, !currentEnabled);\n  return newSelections;\n}\n\n/**\n * 检查本地选择是否与原始状态有变化\n */\nexport function hasCharacterChanges(\n  characterOptions: CharacterOption[],\n  localCharacterSelections: Map<string, boolean>,\n): boolean {\n  for (const char of characterOptions) {\n    const localEnabled = localCharacterSelections.get(char.value) ?? false;\n    if (localEnabled !== char.enabled) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * 保存角色选择到世界书\n * @param characterOptions 角色选项列表\n * @param localCharacterSelections 本地选择状态\n * @param bookName 世界书名称\n * @returns 更新后的角色选项列表\n */\nexport async function saveCharacterChanges(\n  characterOptions: CharacterOption[],\n  localCharacterSelections: Map<string, boolean>,\n  bookName: string,\n): Promise<CharacterOption[]> {\n  if (!hasCharacterChanges(characterOptions, localCharacterSelections)) {\n    return characterOptions;\n  }\n\n  // 构建更新列表\n  const updatedEntries = Array.from(localCharacterSelections).map(([name, enabled]) => ({\n    name,\n    enabled,\n  }));\n\n  await updateWorldBook(updatedEntries, bookName);\n\n  // 返回更新后的角色选项列表\n  return characterOptions.map(char => ({\n    ...char,\n    enabled: localCharacterSelections.get(char.value) ?? false,\n  }));\n}\n\n// ========================\n// 事件相关函数\n// ========================\n\n/**\n * 从条目名称中提取事件Key\n * @param entryName 完整条目名称，如 \"[事件][双子]双子星的咏叹调-本体\"\n * @returns 事件Key，如 \"[事件][双子]\"，如果不匹配则返回null\n */\nfunction extractEventKey(entryName: string): string | null {\n  const match = entryName.match(EVENT_KEY_PATTERN);\n  return match ? match[1] : null;\n}\n\n/**\n * 从事件Key中提取显示名称\n * @param eventKey 事件Key，如 \"[事件][双子]\"\n * @returns 显示名称，如 \"双子\"\n */\nfunction extractEventLabel(eventKey: string): string {\n  const match = eventKey.match(EVENT_LABEL_PATTERN);\n  return match ? match[1] : eventKey;\n}\n\n/**\n * 从事件条目中提取作者和信息\n * @param entries 事件下的所有条目\n * @returns { author: string, info: string }\n */\nfunction extractEventAuthorInfo(entries: EventEntry[]): { author: string; info: string } {\n  for (const entry of entries) {\n    const match = entry.name.match(AUTHOR_PATTERN);\n    if (match) {\n      const authorInfo = match[1].trim();\n      const dashIndex = authorInfo.indexOf('-');\n      if (dashIndex > 0) {\n        return {\n          author: authorInfo.substring(0, dashIndex).trim(),\n          info: authorInfo.substring(dashIndex + 1).trim(),\n        };\n      }\n      return { author: authorInfo, info: '' };\n    }\n  }\n  return { author: '', info: '' };\n}\n\n/**\n * 加载事件列表\n */\nexport async function loadEventOptions(): Promise<{\n  eventOptions: EventOption[];\n  localEventSelections: Map<string, boolean>;\n  bookName: string | null;\n}> {\n  const bookName = getWorldBookName();\n  const entries = await getFilteredEntries(EVENT_PATTERN, bookName);\n\n  // 按事件Key分组条目\n  const eventGroups = new Map<string, EventEntry[]>();\n\n  for (const entry of entries as { name: string; enabled: boolean }[]) {\n    const eventKey = extractEventKey(entry.name);\n    if (!eventKey) continue;\n\n    if (!eventGroups.has(eventKey)) {\n      eventGroups.set(eventKey, []);\n    }\n    eventGroups.get(eventKey)!.push({\n      name: entry.name,\n      enabled: entry.enabled,\n    });\n  }\n\n  // 构建事件选项列表\n  const eventOptions: EventOption[] = [];\n  for (const [eventKey, groupEntries] of eventGroups) {\n    // 事件启用状态：所有条目都启用时为true\n    const allEnabled = groupEntries.every(e => e.enabled);\n    const { author, info } = extractEventAuthorInfo(groupEntries);\n    eventOptions.push({\n      eventKey,\n      label: extractEventLabel(eventKey),\n      author,\n      info,\n      entries: groupEntries,\n      enabled: allEnabled,\n    });\n  }\n\n  // 对事件选项进行排序（按拼音首字母）\n  const sortedEventOptions = sortEventOptions(eventOptions);\n\n  // 初始化本地选择列表（从分组状态复制）\n  const localEventSelections = new Map(\n    sortedEventOptions.map(event => [event.eventKey, event.enabled]),\n  );\n\n  return { eventOptions: sortedEventOptions, localEventSelections, bookName };\n}\n\n/**\n * 切换事件启用状态（更新本地状态，返回新的选择Map）\n */\nexport function toggleEvent(\n  localEventSelections: Map<string, boolean>,\n  eventKey: string,\n): Map<string, boolean> {\n  const newSelections = new Map(localEventSelections);\n  const currentEnabled = newSelections.get(eventKey) ?? false;\n  newSelections.set(eventKey, !currentEnabled);\n  return newSelections;\n}\n\n/**\n * 检查本地事件选择是否与原始状态有变化\n */\nexport function hasEventChanges(\n  eventOptions: EventOption[],\n  localEventSelections: Map<string, boolean>,\n): boolean {\n  for (const event of eventOptions) {\n    const localEnabled = localEventSelections.get(event.eventKey) ?? false;\n    if (localEnabled !== event.enabled) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * 保存事件选择到世界书\n * @param eventOptions 事件选项列表\n * @param localEventSelections 本地选择状态\n * @param bookName 世界书名称\n * @returns 更新后的事件选项列表\n */\nexport async function saveEventChanges(\n  eventOptions: EventOption[],\n  localEventSelections: Map<string, boolean>,\n  bookName: string,\n): Promise<EventOption[]> {\n  if (!hasEventChanges(eventOptions, localEventSelections)) {\n    return eventOptions;\n  }\n\n  // 构建更新列表：将每个事件的所有条目设置为相同的启用状态\n  const updatedEntries: Array<{ name: string; enabled: boolean }> = [];\n\n  for (const event of eventOptions) {\n    const newEnabled = localEventSelections.get(event.eventKey) ?? false;\n    for (const entry of event.entries) {\n      updatedEntries.push({\n        name: entry.name,\n        enabled: newEnabled,\n      });\n    }\n  }\n\n  await updateWorldBook(updatedEntries, bookName);\n\n  // 返回更新后的事件选项列表\n  return eventOptions.map(event => {\n    const newEnabled = localEventSelections.get(event.eventKey) ?? false;\n    return {\n      ...event,\n      enabled: newEnabled,\n      entries: event.entries.map(entry => ({\n        ...entry,\n        enabled: newEnabled,\n      })),\n    };\n  });\n}\n\n// ========================\n// 扩展相关函数\n// ========================\n\n/**\n * 从条目名称中提取扩展Key\n * @param entryName 完整条目名称，如 \"[扩展][无尽深渊地城扩展][!原版无尽深渊地城]无尽深渊地城-控制(Hilo)\"\n * @returns 扩展Key，如 \"[扩展][无尽深渊地城扩展][!原版无尽深渊地城]\"，如果不匹配则返回null\n */\nfunction extractExtensionKey(entryName: string): string | null {\n  const match = entryName.match(EXTENSION_KEY_PATTERN);\n  return match ? match[1] : null;\n}\n\n/**\n * 从扩展Key中提取显示名称\n * @param extensionKey 扩展Key，如 \"[扩展][无尽深渊地城扩展][!原版无尽深渊地城]\"\n * @returns 显示名称，如 \"无尽深渊地城扩展\"\n */\nfunction extractExtensionLabel(extensionKey: string): string {\n  const match = extensionKey.match(EXTENSION_LABEL_PATTERN);\n  return match ? match[1] : extensionKey;\n}\n\n/**\n * 从条目名称中提取所有互斥目标\n * @param entryName 条目名称，如 \"[扩展][无尽深渊地城扩展][!原版无尽深渊地城][!另一个目标]...\"\n * @returns 互斥目标数组\n */\nfunction extractExclusionTargetsFromEntry(entryName: string): string[] {\n  const targets: string[] = [];\n  const regex = new RegExp(EXTENSION_EXCLUSION_PATTERN.source, 'g');\n  let match;\n  while ((match = regex.exec(entryName)) !== null) {\n    targets.push(match[1]);\n  }\n  return targets;\n}\n\n/**\n * 从条目名称中提取所有替换目标\n * @param entryName 条目名称，如 \"[扩展][xxx][>被替换条目]...\"\n * @returns 替换目标数组\n */\nfunction extractReplacementTargetsFromEntry(entryName: string): string[] {\n  const targets: string[] = [];\n  const regex = new RegExp(EXTENSION_REPLACEMENT_PATTERN.source, 'g');\n  let match;\n  while ((match = regex.exec(entryName)) !== null) {\n    targets.push(match[1]);\n  }\n  return targets;\n}\n\n/**\n * 从条目名称中提取所有前置需求\n * @param entryName 条目名称，如 \"[扩展][xxx][<前置扩展]...\"\n * @returns 前置需求数组\n */\nfunction extractPrerequisiteTargetsFromEntry(entryName: string): string[] {\n  const targets: string[] = [];\n  const regex = new RegExp(EXTENSION_PREREQUISITE_PATTERN.source, 'g');\n  let match;\n  while ((match = regex.exec(entryName)) !== null) {\n    targets.push(match[1]);\n  }\n  return targets;\n}\n\n/**\n * 从扩展条目数组中提取所有互斥目标（合并所有条目的标记并去重）\n * @param entries 扩展下的所有条目\n * @returns 互斥目标数组\n */\nfunction extractExtensionExclusionTargets(entries: ExtensionEntry[]): string[] {\n  const allTargets = new Set<string>();\n  for (const entry of entries) {\n    const targets = extractExclusionTargetsFromEntry(entry.name);\n    targets.forEach(t => allTargets.add(t));\n  }\n  return Array.from(allTargets);\n}\n\n/**\n * 从扩展条目数组中提取所有替换目标（合并所有条目的标记并去重）\n * @param entries 扩展下的所有条目\n * @returns 替换目标数组\n */\nfunction extractExtensionReplacementTargets(entries: ExtensionEntry[]): string[] {\n  const allTargets = new Set<string>();\n  for (const entry of entries) {\n    const targets = extractReplacementTargetsFromEntry(entry.name);\n    targets.forEach(t => allTargets.add(t));\n  }\n  return Array.from(allTargets);\n}\n\n/**\n * 从扩展条目数组中提取所有前置需求（合并所有条目的标记并去重）\n * @param entries 扩展下的所有条目\n * @returns 前置需求数组\n */\nfunction extractExtensionPrerequisiteTargets(entries: ExtensionEntry[]): string[] {\n  const allTargets = new Set<string>();\n  for (const entry of entries) {\n    const targets = extractPrerequisiteTargetsFromEntry(entry.name);\n    targets.forEach(t => allTargets.add(t));\n  }\n  return Array.from(allTargets);\n}\n\n/**\n * 从扩展条目中提取作者和信息\n * @param entries 扩展下的所有条目\n * @returns { author: string, info: string }\n */\nfunction extractExtensionAuthorInfo(entries: ExtensionEntry[]): { author: string; info: string } {\n  for (const entry of entries) {\n    const match = entry.name.match(AUTHOR_PATTERN);\n    if (match) {\n      const authorInfo = match[1].trim();\n      const dashIndex = authorInfo.indexOf('-');\n      if (dashIndex > 0) {\n        return {\n          author: authorInfo.substring(0, dashIndex).trim(),\n          info: authorInfo.substring(dashIndex + 1).trim(),\n        };\n      }\n      return { author: authorInfo, info: '' };\n    }\n  }\n  return { author: '', info: '' };\n}\n\n/**\n * 加载扩展列表\n */\nexport async function loadExtensionOptions(): Promise<{\n  extensionOptions: ExtensionOption[];\n  localExtensionSelections: Map<string, boolean>;\n  bookName: string | null;\n}> {\n  const bookName = getWorldBookName();\n  const entries = await getFilteredEntries(EXTENSION_PATTERN, bookName);\n\n  // 按扩展Key分组条目\n  const extensionGroups = new Map<string, ExtensionEntry[]>();\n\n  for (const entry of entries as { name: string; enabled: boolean }[]) {\n    const extensionKey = extractExtensionKey(entry.name);\n    if (!extensionKey) continue;\n\n    if (!extensionGroups.has(extensionKey)) {\n      extensionGroups.set(extensionKey, []);\n    }\n    extensionGroups.get(extensionKey)!.push({\n      name: entry.name,\n      enabled: entry.enabled,\n    });\n  }\n\n  // 构建扩展选项列表\n  const extensionOptions: ExtensionOption[] = [];\n  for (const [extensionKey, groupEntries] of extensionGroups) {\n    // 扩展启用状态：所有条目都启用时为true\n    const allEnabled = groupEntries.every(e => e.enabled);\n    const { author, info } = extractExtensionAuthorInfo(groupEntries);\n    extensionOptions.push({\n      extensionKey,\n      label: extractExtensionLabel(extensionKey),\n      author,\n      info,\n      exclusionTargets: extractExtensionExclusionTargets(groupEntries),\n      replacementTargets: extractExtensionReplacementTargets(groupEntries),\n      prerequisiteTargets: extractExtensionPrerequisiteTargets(groupEntries),\n      entries: groupEntries,\n      enabled: allEnabled,\n    });\n  }\n\n  // 对扩展选项进行排序（按拼音首字母）\n  const sortedExtensionOptions = sortExtensionOptions(extensionOptions);\n\n  // 初始化本地选择列表（从分组状态复制）\n  const localExtensionSelections = new Map(\n    sortedExtensionOptions.map(ext => [ext.extensionKey, ext.enabled]),\n  );\n\n  return { extensionOptions: sortedExtensionOptions, localExtensionSelections, bookName };\n}\n\n/**\n * 检查前置需求是否满足\n * @param extensionOptions 扩展选项列表\n * @param localExtensionSelections 本地选择状态\n * @param prerequisiteTargets 前置需求目标数组\n * @returns { satisfied: boolean, missingPrerequisites: string[] }\n */\nfunction checkPrerequisites(\n  extensionOptions: ExtensionOption[],\n  localExtensionSelections: Map<string, boolean>,\n  prerequisiteTargets: string[],\n): { satisfied: boolean; missingPrerequisites: string[] } {\n  const missingPrerequisites: string[] = [];\n\n  for (const target of prerequisiteTargets) {\n    // 查找包含 [target] 的扩展\n    const prerequisiteExtension = extensionOptions.find(ext =>\n      ext.extensionKey.includes(`[${target}]`),\n    );\n    if (prerequisiteExtension) {\n      const isEnabled = localExtensionSelections.get(prerequisiteExtension.extensionKey) ?? false;\n      if (!isEnabled) {\n        missingPrerequisites.push(target);\n      }\n    } else {\n      // 如果找不到对应的扩展，记录为缺失\n      missingPrerequisites.push(target);\n    }\n  }\n\n  return {\n    satisfied: missingPrerequisites.length === 0,\n    missingPrerequisites,\n  };\n}\n\n/**\n * 切换扩展启用状态的结果\n */\nexport interface ToggleExtensionResult {\n  selections: Map<string, boolean>;\n  success: boolean;\n  error?: string;\n  missingPrerequisites?: string[];\n}\n\n/**\n * 切换扩展启用状态（更新本地状态，返回新的选择Map和结果状态）\n *\n * 处理三种关系：\n * 1. 互斥 [!xxx]：开启时关闭包含 [xxx] 的扩展（扩展之间互斥）\n * 2. 替换 [>xxx]：开启时关闭包含 [xxx] 的条目，关闭时无特殊处理（保存时处理恢复）\n * 3. 前置需求 [<xxx]：开启时检查 [xxx] 扩展是否已开启\n */\nexport function toggleExtension(\n  localExtensionSelections: Map<string, boolean>,\n  extensionOptions: ExtensionOption[],\n  extensionKey: string,\n): ToggleExtensionResult {\n  const newSelections = new Map(localExtensionSelections);\n  const currentEnabled = newSelections.get(extensionKey) ?? false;\n  const newEnabled = !currentEnabled;\n\n  const targetExtension = extensionOptions.find(ext => ext.extensionKey === extensionKey);\n\n  // 如果正在启用扩展，需要检查前置需求\n  if (newEnabled && targetExtension) {\n    // 检查前置需求\n    if (targetExtension.prerequisiteTargets.length > 0) {\n      const { satisfied, missingPrerequisites } = checkPrerequisites(\n        extensionOptions,\n        newSelections,\n        targetExtension.prerequisiteTargets,\n      );\n\n      if (!satisfied) {\n        return {\n          selections: localExtensionSelections, // 返回原始选择，不做改变\n          success: false,\n          error: `缺少前置需求: ${missingPrerequisites.join(', ')}`,\n          missingPrerequisites,\n        };\n      }\n    }\n  }\n\n  newSelections.set(extensionKey, newEnabled);\n\n  // 如果正在启用扩展，处理互斥逻辑\n  if (newEnabled && targetExtension) {\n    // 处理互斥目标\n    for (const exclusionTarget of targetExtension.exclusionTargets) {\n      // 查找所有包含 [互斥目标] 的扩展并禁用\n      for (const ext of extensionOptions) {\n        // 检查扩展label是否匹配互斥目标，或扩展Key是否包含 [互斥目标]\n        if (\n          ext.extensionKey !== extensionKey &&\n          (ext.label === exclusionTarget || ext.extensionKey.includes(`[${exclusionTarget}]`))\n        ) {\n          newSelections.set(ext.extensionKey, false);\n        }\n      }\n    }\n  }\n\n  // 如果正在禁用扩展，检查是否有其他扩展依赖此扩展作为前置需求\n  if (!newEnabled && targetExtension) {\n    // 查找所有依赖当前扩展的扩展并禁用它们\n    for (const ext of extensionOptions) {\n      if (ext.extensionKey !== extensionKey) {\n        const isEnabled = newSelections.get(ext.extensionKey) ?? false;\n        if (isEnabled && ext.prerequisiteTargets.includes(targetExtension.label)) {\n          // 递归禁用依赖此扩展的扩展\n          newSelections.set(ext.extensionKey, false);\n        }\n      }\n    }\n  }\n\n  return {\n    selections: newSelections,\n    success: true,\n  };\n}\n\n/**\n * 检查本地扩展选择是否与原始状态有变化\n */\nexport function hasExtensionChanges(\n  extensionOptions: ExtensionOption[],\n  localExtensionSelections: Map<string, boolean>,\n): boolean {\n  for (const ext of extensionOptions) {\n    const localEnabled = localExtensionSelections.get(ext.extensionKey) ?? false;\n    if (localEnabled !== ext.enabled) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * 收集所有被启用扩展的互斥目标（需要禁用的目标）\n * @param extensionOptions 扩展选项列表\n * @param localExtensionSelections 本地选择状态\n * @returns 互斥目标数组\n */\nfunction collectExclusionTargetsToDisable(\n  extensionOptions: ExtensionOption[],\n  localExtensionSelections: Map<string, boolean>,\n): string[] {\n  const exclusionTargets: string[] = [];\n\n  for (const ext of extensionOptions) {\n    const isEnabled = localExtensionSelections.get(ext.extensionKey) ?? false;\n    if (isEnabled && ext.exclusionTargets.length > 0) {\n      exclusionTargets.push(...ext.exclusionTargets);\n    }\n  }\n\n  // 去重\n  return [...new Set(exclusionTargets)];\n}\n\n/**\n * 收集所有被启用扩展的替换目标（需要禁用的条目）\n * @param extensionOptions 扩展选项列表\n * @param localExtensionSelections 本地选择状态\n * @returns 替换目标数组\n */\nfunction collectReplacementTargetsToDisable(\n  extensionOptions: ExtensionOption[],\n  localExtensionSelections: Map<string, boolean>,\n): string[] {\n  const replacementTargets: string[] = [];\n\n  for (const ext of extensionOptions) {\n    const isEnabled = localExtensionSelections.get(ext.extensionKey) ?? false;\n    if (isEnabled && ext.replacementTargets.length > 0) {\n      replacementTargets.push(...ext.replacementTargets);\n    }\n  }\n\n  // 去重\n  return [...new Set(replacementTargets)];\n}\n\n/**\n * 收集所有被禁用扩展的替换目标（需要恢复启用的条目）\n * @param extensionOptions 扩展选项列表\n * @param localExtensionSelections 本地选择状态\n * @param originalExtensionStates 原始扩展状态（用于判断扩展是否从启用变为禁用）\n * @returns 替换目标数组\n */\nfunction collectReplacementTargetsToEnable(\n  extensionOptions: ExtensionOption[],\n  localExtensionSelections: Map<string, boolean>,\n  originalExtensionStates: Map<string, boolean>,\n): string[] {\n  const replacementTargets: string[] = [];\n\n  for (const ext of extensionOptions) {\n    const isEnabled = localExtensionSelections.get(ext.extensionKey) ?? false;\n    const wasEnabled = originalExtensionStates.get(ext.extensionKey) ?? false;\n\n    // 只有当扩展从启用变为禁用时，才恢复替换目标\n    if (!isEnabled && wasEnabled && ext.replacementTargets.length > 0) {\n      replacementTargets.push(...ext.replacementTargets);\n    }\n  }\n\n  // 去重\n  return [...new Set(replacementTargets)];\n}\n\n/**\n * 保存扩展选择到世界书\n * @param extensionOptions 扩展选项列表\n * @param localExtensionSelections 本地选择状态\n * @param bookName 世界书名称\n * @returns 更新后的扩展选项列表\n */\nexport async function saveExtensionChanges(\n  extensionOptions: ExtensionOption[],\n  localExtensionSelections: Map<string, boolean>,\n  bookName: string,\n): Promise<ExtensionOption[]> {\n  if (!hasExtensionChanges(extensionOptions, localExtensionSelections)) {\n    return extensionOptions;\n  }\n\n  // 构建原始扩展状态映射\n  const originalExtensionStates = new Map(\n    extensionOptions.map(ext => [ext.extensionKey, ext.enabled]),\n  );\n\n  // 构建更新列表：将每个扩展的所有条目设置为相同的启用状态\n  const updatedEntries: Array<{ name: string; enabled: boolean }> = [];\n\n  for (const ext of extensionOptions) {\n    const newEnabled = localExtensionSelections.get(ext.extensionKey) ?? false;\n    for (const entry of ext.entries) {\n      updatedEntries.push({\n        name: entry.name,\n        enabled: newEnabled,\n      });\n    }\n  }\n\n  // 收集所有被启用扩展的互斥目标（需要禁用）\n  const exclusionTargetsToDisable = collectExclusionTargetsToDisable(\n    extensionOptions,\n    localExtensionSelections,\n  );\n\n  // 收集所有被启用扩展的替换目标（需要禁用）\n  const replacementTargetsToDisable = collectReplacementTargetsToDisable(\n    extensionOptions,\n    localExtensionSelections,\n  );\n\n  // 收集所有被禁用扩展的替换目标（需要恢复启用）\n  const replacementTargetsToEnable = collectReplacementTargetsToEnable(\n    extensionOptions,\n    localExtensionSelections,\n    originalExtensionStates,\n  );\n\n  // 从需要启用的替换目标中排除需要禁用的目标（禁用优先级更高）\n  const filteredReplacementTargetsToEnable = replacementTargetsToEnable.filter(\n    target =>\n      !replacementTargetsToDisable.includes(target) && !exclusionTargetsToDisable.includes(target),\n  );\n\n  // 处理互斥逻辑：禁用包含 [互斥目标] 的扩展条目\n  if (exclusionTargetsToDisable.length > 0) {\n    for (const target of exclusionTargetsToDisable) {\n      const pattern = new RegExp(`\\\\[${escapeRegExp(target)}\\\\]`);\n      const matchingEntries = await getFilteredEntries(pattern, bookName);\n\n      for (const entry of matchingEntries as { name: string; enabled: boolean }[]) {\n        // 检查是否已经在更新列表中\n        const existingIndex = updatedEntries.findIndex(e => e.name === entry.name);\n        if (existingIndex === -1) {\n          updatedEntries.push({\n            name: entry.name,\n            enabled: false,\n          });\n        } else {\n          // 如果已存在，确保设置为禁用\n          updatedEntries[existingIndex].enabled = false;\n        }\n      }\n    }\n  }\n\n  // 处理替换逻辑（禁用）：禁用包含 [替换目标] 的条目\n  if (replacementTargetsToDisable.length > 0) {\n    for (const target of replacementTargetsToDisable) {\n      const pattern = new RegExp(`\\\\[${escapeRegExp(target)}\\\\]`);\n      const matchingEntries = await getFilteredEntries(pattern, bookName);\n\n      for (const entry of matchingEntries as { name: string; enabled: boolean }[]) {\n        // 检查是否已经在更新列表中\n        const existingIndex = updatedEntries.findIndex(e => e.name === entry.name);\n        if (existingIndex === -1) {\n          updatedEntries.push({\n            name: entry.name,\n            enabled: false,\n          });\n        } else {\n          // 如果已存在，确保设置为禁用（替换目标禁用优先级高）\n          updatedEntries[existingIndex].enabled = false;\n        }\n      }\n    }\n  }\n\n  // 处理替换逻辑（恢复启用）：启用包含 [替换目标] 的条目（当扩展关闭时）\n  if (filteredReplacementTargetsToEnable.length > 0) {\n    for (const target of filteredReplacementTargetsToEnable) {\n      const pattern = new RegExp(`\\\\[${escapeRegExp(target)}\\\\]`);\n      const matchingEntries = await getFilteredEntries(pattern, bookName);\n\n      for (const entry of matchingEntries as { name: string; enabled: boolean }[]) {\n        // 检查是否已经在更新列表中\n        const existingIndex = updatedEntries.findIndex(e => e.name === entry.name);\n        if (existingIndex === -1) {\n          updatedEntries.push({\n            name: entry.name,\n            enabled: true,\n          });\n        } else if (updatedEntries[existingIndex].enabled !== false) {\n          // 如果已存在且不是被禁用的目标，则启用\n          // 注意：禁用的优先级更高，所以这里不覆盖已禁用的条目\n          updatedEntries[existingIndex].enabled = true;\n        }\n      }\n    }\n  }\n\n  await updateWorldBook(updatedEntries, bookName);\n\n  // 返回更新后的扩展选项列表\n  return extensionOptions.map(ext => {\n    const newEnabled = localExtensionSelections.get(ext.extensionKey) ?? false;\n    return {\n      ...ext,\n      enabled: newEnabled,\n      entries: ext.entries.map(entry => ({\n        ...entry,\n        enabled: newEnabled,\n      })),\n    };\n  });\n}\n\n/**\n * 辅助函数：转义正则表达式特殊字符\n */\nfunction escapeRegExp(string: string): string {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, vShow as _vShow, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = { class: \"settings-page\" };\nconst _hoisted_2 = { class: \"control-panel-container\" };\nconst _hoisted_3 = { class: \"tab-navigation\" };\nconst _hoisted_4 = [\"disabled\"];\nconst _hoisted_5 = { class: \"tab-content\" };\nconst _hoisted_6 = { class: \"control-group\" };\nconst _hoisted_7 = {\n    key: 0,\n    class: \"loading-text\"\n};\nconst _hoisted_8 = {\n    key: 1,\n    class: \"empty-text\"\n};\nconst _hoisted_9 = {\n    key: 2,\n    class: \"list-detail-layout\"\n};\nconst _hoisted_10 = { class: \"item-list\" };\nconst _hoisted_11 = [\"onClick\"];\nconst _hoisted_12 = { class: \"item-detail\" };\nconst _hoisted_13 = { class: \"detail-name\" };\nconst _hoisted_14 = { class: \"detail-row\" };\nconst _hoisted_15 = { class: \"detail-value\" };\nconst _hoisted_16 = { class: \"detail-row\" };\nconst _hoisted_17 = { class: \"detail-value\" };\nconst _hoisted_18 = { class: \"detail-actions\" };\nconst _hoisted_19 = {\n    key: 1,\n    class: \"detail-placeholder\"\n};\nconst _hoisted_20 = { class: \"control-group\" };\nconst _hoisted_21 = {\n    key: 0,\n    class: \"loading-text\"\n};\nconst _hoisted_22 = {\n    key: 1,\n    class: \"empty-text\"\n};\nconst _hoisted_23 = {\n    key: 2,\n    class: \"list-detail-layout\"\n};\nconst _hoisted_24 = { class: \"item-list\" };\nconst _hoisted_25 = [\"onClick\"];\nconst _hoisted_26 = { class: \"item-detail\" };\nconst _hoisted_27 = { class: \"detail-name\" };\nconst _hoisted_28 = { class: \"detail-row\" };\nconst _hoisted_29 = { class: \"detail-value\" };\nconst _hoisted_30 = { class: \"detail-row\" };\nconst _hoisted_31 = { class: \"detail-value\" };\nconst _hoisted_32 = { class: \"detail-row\" };\nconst _hoisted_33 = { class: \"detail-value\" };\nconst _hoisted_34 = { class: \"detail-actions\" };\nconst _hoisted_35 = {\n    key: 1,\n    class: \"detail-placeholder\"\n};\nconst _hoisted_36 = { class: \"control-group\" };\nconst _hoisted_37 = {\n    key: 0,\n    class: \"loading-text\"\n};\nconst _hoisted_38 = {\n    key: 1,\n    class: \"empty-text\"\n};\nconst _hoisted_39 = {\n    key: 2,\n    class: \"list-detail-layout\"\n};\nconst _hoisted_40 = { class: \"item-list\" };\nconst _hoisted_41 = [\"onClick\"];\nconst _hoisted_42 = { class: \"item-detail\" };\nconst _hoisted_43 = { class: \"detail-name\" };\nconst _hoisted_44 = { class: \"detail-row\" };\nconst _hoisted_45 = { class: \"detail-value\" };\nconst _hoisted_46 = { class: \"detail-row\" };\nconst _hoisted_47 = { class: \"detail-value\" };\nconst _hoisted_48 = {\n    key: 0,\n    class: \"detail-row\"\n};\nconst _hoisted_49 = { class: \"detail-value exclusion-hint\" };\nconst _hoisted_50 = {\n    key: 1,\n    class: \"detail-row\"\n};\nconst _hoisted_51 = { class: \"detail-value replacement-hint\" };\nconst _hoisted_52 = {\n    key: 2,\n    class: \"detail-row\"\n};\nconst _hoisted_53 = { class: \"detail-value prerequisite-hint\" };\nconst _hoisted_54 = { class: \"detail-row\" };\nconst _hoisted_55 = { class: \"detail-value\" };\nconst _hoisted_56 = { class: \"detail-actions\" };\nconst _hoisted_57 = {\n    key: 1,\n    class: \"detail-placeholder\"\n};\nconst _hoisted_58 = { class: \"step-footer\" };\nconst _hoisted_59 = [\"disabled\"];\nimport { computed, onMounted, ref } from 'vue';\nimport { initialCharacterState, initialEventState, initialExtensionState, loadCharacterOptions as loadCharacterOptionsService, loadEventOptions as loadEventOptionsService, loadExtensionOptions as loadExtensionOptionsService, saveCharacterChanges as saveCharacterChangesService, saveEventChanges as saveEventChangesService, saveExtensionChanges as saveExtensionChangesService, toggleCharacter, toggleEvent, toggleExtension, } from '../services/DLCManagement';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DLCManagementPage',\n    emits: [\"next\"],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const isLoading = ref(false);\n        const isSaving = ref(false);\n        // Tab 状态\n        const activeTab = ref('characters');\n        // 选中项状态\n        const selectedCharacter = ref(null);\n        const selectedEvent = ref(null);\n        const selectedExtension = ref(null);\n        // 角色相关状态\n        const characterOptions = ref([...initialCharacterState.characterOptions]);\n        const localCharacterSelections = ref(new Map(initialCharacterState.localCharacterSelections));\n        // 事件相关状态\n        const eventOptions = ref([...initialEventState.eventOptions]);\n        const localEventSelections = ref(new Map(initialEventState.localEventSelections));\n        // 扩展相关状态\n        const extensionOptions = ref([...initialExtensionState.extensionOptions]);\n        const localExtensionSelections = ref(new Map(initialExtensionState.localExtensionSelections));\n        const bookName = ref(null);\n        // 计算属性：获取选中项的详细信息\n        const getSelectedCharacterInfo = computed(() => {\n            if (!selectedCharacter.value)\n                return null;\n            return characterOptions.value.find(c => c.value === selectedCharacter.value) || null;\n        });\n        const getSelectedEventInfo = computed(() => {\n            if (!selectedEvent.value)\n                return null;\n            return eventOptions.value.find(e => e.eventKey === selectedEvent.value) || null;\n        });\n        const getSelectedExtensionInfo = computed(() => {\n            if (!selectedExtension.value)\n                return null;\n            return extensionOptions.value.find(e => e.extensionKey === selectedExtension.value) || null;\n        });\n        async function loadAllOptions() {\n            isLoading.value = true;\n            try {\n                // 并行加载角色、事件和扩展列表\n                const [charResult, eventResult, extResult] = await Promise.all([\n                    loadCharacterOptionsService(),\n                    loadEventOptionsService(),\n                    loadExtensionOptionsService(),\n                ]);\n                // 角色数据\n                characterOptions.value = charResult.characterOptions;\n                localCharacterSelections.value = charResult.localCharacterSelections;\n                bookName.value = charResult.bookName;\n                // 事件数据\n                eventOptions.value = eventResult.eventOptions;\n                localEventSelections.value = eventResult.localEventSelections;\n                // 扩展数据\n                extensionOptions.value = extResult.extensionOptions;\n                localExtensionSelections.value = extResult.localExtensionSelections;\n            }\n            catch (error) {\n                console.error('加载DLC数据失败:', error);\n                characterOptions.value = [];\n                localCharacterSelections.value = new Map();\n                eventOptions.value = [];\n                localEventSelections.value = new Map();\n                extensionOptions.value = [];\n                localExtensionSelections.value = new Map();\n                bookName.value = null;\n            }\n            finally {\n                isLoading.value = false;\n            }\n        }\n        async function handleRefresh() {\n            await loadAllOptions();\n        }\n        function handleToggleCharacter(characterValue) {\n            localCharacterSelections.value = toggleCharacter(localCharacterSelections.value, characterValue);\n        }\n        function handleToggleEvent(eventKey) {\n            localEventSelections.value = toggleEvent(localEventSelections.value, eventKey);\n        }\n        function handleToggleExtension(extensionKey) {\n            const result = toggleExtension(localExtensionSelections.value, extensionOptions.value, extensionKey);\n            if (result.success) {\n                localExtensionSelections.value = result.selections;\n            }\n            else {\n                // 前置需求不满足时显示错误提示\n                alert(result.error || '操作失败');\n            }\n        }\n        /**\n         * 点击下一步：根据本地列表更新世界书后跳转\n         * 注意：必须顺序保存，避免并行调用 updateWorldBook 导致竞态条件\n         */\n        async function handleNext() {\n            isSaving.value = true;\n            try {\n                if (bookName.value) {\n                    // 顺序保存角色、事件和扩展选择，避免竞态条件\n                    const updatedCharacters = await saveCharacterChangesService(characterOptions.value, localCharacterSelections.value, bookName.value);\n                    characterOptions.value = updatedCharacters;\n                    const updatedEvents = await saveEventChangesService(eventOptions.value, localEventSelections.value, bookName.value);\n                    eventOptions.value = updatedEvents;\n                    const updatedExtensions = await saveExtensionChangesService(extensionOptions.value, localExtensionSelections.value, bookName.value);\n                    extensionOptions.value = updatedExtensions;\n                }\n            }\n            catch (error) {\n                console.error('保存DLC选择失败:', error);\n            }\n            finally {\n                isSaving.value = false;\n            }\n            emit('next');\n        }\n        // 组件挂载时加载所有选项\n        onMounted(() => {\n            loadAllOptions();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[21] || (_cache[21] = _createElementVNode(\"h2\", { class: \"main-title\" }, \"DLC 管理\", -1 /* CACHED */)),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createCommentVNode(\" Tab 导航 \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"button\", {\n                            class: _normalizeClass([\"tab-button\", { active: activeTab.value === 'characters' }]),\n                            onClick: _cache[0] || (_cache[0] = ($event) => {\n                                activeTab.value = 'characters';\n                                selectedCharacter.value = null;\n                            })\n                        }, [...(_cache[6] || (_cache[6] = [\n                                _createElementVNode(\"span\", { class: \"tab-label\" }, \"角色\", -1 /* CACHED */)\n                            ]))], 2 /* CLASS */),\n                        _createElementVNode(\"button\", {\n                            class: _normalizeClass([\"tab-button\", { active: activeTab.value === 'events' }]),\n                            onClick: _cache[1] || (_cache[1] = ($event) => {\n                                activeTab.value = 'events';\n                                selectedEvent.value = null;\n                            })\n                        }, [...(_cache[7] || (_cache[7] = [\n                                _createElementVNode(\"span\", { class: \"tab-label\" }, \"事件\", -1 /* CACHED */)\n                            ]))], 2 /* CLASS */),\n                        _createElementVNode(\"button\", {\n                            class: _normalizeClass([\"tab-button\", { active: activeTab.value === 'extensions' }]),\n                            onClick: _cache[2] || (_cache[2] = ($event) => {\n                                activeTab.value = 'extensions';\n                                selectedExtension.value = null;\n                            })\n                        }, [...(_cache[8] || (_cache[8] = [\n                                _createElementVNode(\"span\", { class: \"tab-label\" }, \"扩展\", -1 /* CACHED */)\n                            ]))], 2 /* CLASS */),\n                        _createElementVNode(\"button\", {\n                            class: \"refresh-button\",\n                            disabled: isLoading.value,\n                            title: \"刷新列表\",\n                            onClick: handleRefresh\n                        }, [\n                            _createElementVNode(\"span\", {\n                                class: _normalizeClass({ 'is-spinning': isLoading.value })\n                            }, \"⟳\", 2 /* CLASS */)\n                        ], 8 /* PROPS */, _hoisted_4)\n                    ]),\n                    _createCommentVNode(\" Tab 内容区域 \"),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createCommentVNode(\" 角色列表 (DLC - Characters) \"),\n                        _withDirectives(_createElementVNode(\"div\", _hoisted_6, [\n                            (isLoading.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, \"正在加载角色列表...\"))\n                                : (characterOptions.value.length === 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"未找到可用的角色\"))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                                        _createElementVNode(\"div\", _hoisted_10, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(characterOptions.value, (char) => {\n                                                return (_openBlock(), _createElementBlock(\"button\", {\n                                                    key: char.value,\n                                                    class: _normalizeClass([\"list-item\", {\n                                                            'toggled-on': localCharacterSelections.value.get(char.value),\n                                                            selected: selectedCharacter.value === char.value,\n                                                        }]),\n                                                    onClick: ($event) => (selectedCharacter.value = char.value)\n                                                }, _toDisplayString(char.label), 11 /* TEXT, CLASS, PROPS */, _hoisted_11));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_12, [\n                                            (selectedCharacter.value && getSelectedCharacterInfo.value)\n                                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                                    _createElementVNode(\"h3\", _hoisted_13, _toDisplayString(getSelectedCharacterInfo.value.label), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", _hoisted_14, [\n                                                        _cache[9] || (_cache[9] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"作者:\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_15, _toDisplayString(getSelectedCharacterInfo.value.author || '未知'), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_16, [\n                                                        _cache[10] || (_cache[10] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"信息:\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_17, _toDisplayString(getSelectedCharacterInfo.value.info || '无'), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_18, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: _normalizeClass([\"toggle-btn\", { 'toggled-on': localCharacterSelections.value.get(selectedCharacter.value) }]),\n                                                            onClick: _cache[3] || (_cache[3] = ($event) => (handleToggleCharacter(selectedCharacter.value)))\n                                                        }, _toDisplayString(localCharacterSelections.value.get(selectedCharacter.value) ? '已启用' : '已禁用'), 3 /* TEXT, CLASS */)\n                                                    ])\n                                                ], 64 /* STABLE_FRAGMENT */))\n                                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_19, \"请选择一个角色查看详情\"))\n                                        ])\n                                    ]))\n                        ], 512 /* NEED_PATCH */), [\n                            [_vShow, activeTab.value === 'characters']\n                        ]),\n                        _createCommentVNode(\" 事件开关 (DLC - Events) \"),\n                        _withDirectives(_createElementVNode(\"div\", _hoisted_20, [\n                            (isLoading.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, \"正在加载事件列表...\"))\n                                : (eventOptions.value.length === 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_22, \"未找到可用的事件\"))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_23, [\n                                        _createElementVNode(\"div\", _hoisted_24, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(eventOptions.value, (event) => {\n                                                return (_openBlock(), _createElementBlock(\"button\", {\n                                                    key: event.eventKey,\n                                                    class: _normalizeClass([\"list-item\", {\n                                                            'toggled-on': localEventSelections.value.get(event.eventKey),\n                                                            selected: selectedEvent.value === event.eventKey,\n                                                        }]),\n                                                    onClick: ($event) => (selectedEvent.value = event.eventKey)\n                                                }, _toDisplayString(event.label), 11 /* TEXT, CLASS, PROPS */, _hoisted_25));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_26, [\n                                            (selectedEvent.value && getSelectedEventInfo.value)\n                                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                                    _createElementVNode(\"h3\", _hoisted_27, _toDisplayString(getSelectedEventInfo.value.label), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", _hoisted_28, [\n                                                        _cache[11] || (_cache[11] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"作者:\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_29, _toDisplayString(getSelectedEventInfo.value.author || '未知'), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_30, [\n                                                        _cache[12] || (_cache[12] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"大小:\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_31, _toDisplayString(getSelectedEventInfo.value.entries.length) + \" 个条目\", 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_32, [\n                                                        _cache[13] || (_cache[13] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"信息:\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_33, _toDisplayString(getSelectedEventInfo.value.info || '无'), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_34, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: _normalizeClass([\"toggle-btn\", { 'toggled-on': localEventSelections.value.get(selectedEvent.value) }]),\n                                                            onClick: _cache[4] || (_cache[4] = ($event) => (handleToggleEvent(selectedEvent.value)))\n                                                        }, _toDisplayString(localEventSelections.value.get(selectedEvent.value) ? '已启用' : '已禁用'), 3 /* TEXT, CLASS */)\n                                                    ])\n                                                ], 64 /* STABLE_FRAGMENT */))\n                                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_35, \"请选择一个事件查看详情\"))\n                                        ])\n                                    ]))\n                        ], 512 /* NEED_PATCH */), [\n                            [_vShow, activeTab.value === 'events']\n                        ]),\n                        _createCommentVNode(\" 扩展开关 (DLC - Extension) \"),\n                        _withDirectives(_createElementVNode(\"div\", _hoisted_36, [\n                            (isLoading.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_37, \"正在加载扩展列表...\"))\n                                : (extensionOptions.value.length === 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_38, \"未找到可用的扩展\"))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_39, [\n                                        _createElementVNode(\"div\", _hoisted_40, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(extensionOptions.value, (ext) => {\n                                                return (_openBlock(), _createElementBlock(\"button\", {\n                                                    key: ext.extensionKey,\n                                                    class: _normalizeClass([\"list-item\", {\n                                                            'toggled-on': localExtensionSelections.value.get(ext.extensionKey),\n                                                            selected: selectedExtension.value === ext.extensionKey,\n                                                        }]),\n                                                    onClick: ($event) => (selectedExtension.value = ext.extensionKey)\n                                                }, _toDisplayString(ext.label), 11 /* TEXT, CLASS, PROPS */, _hoisted_41));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_42, [\n                                            (selectedExtension.value && getSelectedExtensionInfo.value)\n                                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                                    _createElementVNode(\"h3\", _hoisted_43, _toDisplayString(getSelectedExtensionInfo.value.label), 1 /* TEXT */),\n                                                    _createElementVNode(\"div\", _hoisted_44, [\n                                                        _cache[14] || (_cache[14] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"作者:\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_45, _toDisplayString(getSelectedExtensionInfo.value.author || '未知'), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_46, [\n                                                        _cache[15] || (_cache[15] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"大小:\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_47, _toDisplayString(getSelectedExtensionInfo.value.entries.length) + \" 个条目\", 1 /* TEXT */)\n                                                    ]),\n                                                    (getSelectedExtensionInfo.value.exclusionTargets.length > 0)\n                                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_48, [\n                                                            _cache[16] || (_cache[16] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"互斥:\", -1 /* CACHED */)),\n                                                            _createElementVNode(\"span\", _hoisted_49, _toDisplayString(getSelectedExtensionInfo.value.exclusionTargets.join(', ')), 1 /* TEXT */)\n                                                        ]))\n                                                        : _createCommentVNode(\"v-if\", true),\n                                                    (getSelectedExtensionInfo.value.replacementTargets.length > 0)\n                                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_50, [\n                                                            _cache[17] || (_cache[17] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"替换:\", -1 /* CACHED */)),\n                                                            _createElementVNode(\"span\", _hoisted_51, _toDisplayString(getSelectedExtensionInfo.value.replacementTargets.join(', ')), 1 /* TEXT */)\n                                                        ]))\n                                                        : _createCommentVNode(\"v-if\", true),\n                                                    (getSelectedExtensionInfo.value.prerequisiteTargets.length > 0)\n                                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_52, [\n                                                            _cache[18] || (_cache[18] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"前置:\", -1 /* CACHED */)),\n                                                            _createElementVNode(\"span\", _hoisted_53, _toDisplayString(getSelectedExtensionInfo.value.prerequisiteTargets.join(', ')), 1 /* TEXT */)\n                                                        ]))\n                                                        : _createCommentVNode(\"v-if\", true),\n                                                    _createElementVNode(\"div\", _hoisted_54, [\n                                                        _cache[19] || (_cache[19] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"信息:\", -1 /* CACHED */)),\n                                                        _createElementVNode(\"span\", _hoisted_55, _toDisplayString(getSelectedExtensionInfo.value.info || '无'), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"div\", _hoisted_56, [\n                                                        _createElementVNode(\"button\", {\n                                                            class: _normalizeClass([\"toggle-btn\", { 'toggled-on': localExtensionSelections.value.get(selectedExtension.value) }]),\n                                                            onClick: _cache[5] || (_cache[5] = ($event) => (handleToggleExtension(selectedExtension.value)))\n                                                        }, _toDisplayString(localExtensionSelections.value.get(selectedExtension.value) ? '已启用' : '已禁用'), 3 /* TEXT, CLASS */)\n                                                    ])\n                                                ], 64 /* STABLE_FRAGMENT */))\n                                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_57, \"请选择一个扩展查看详情\"))\n                                        ])\n                                    ]))\n                        ], 512 /* NEED_PATCH */), [\n                            [_vShow, activeTab.value === 'extensions']\n                        ])\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_58, [\n                    _cache[20] || (_cache[20] = _createElementVNode(\"div\", null, null, -1 /* CACHED */)),\n                    _createElementVNode(\"button\", {\n                        class: \"nav-button\",\n                        disabled: isLoading.value || isSaving.value,\n                        onClick: handleNext\n                    }, [\n                        _createElementVNode(\"span\", null, _toDisplayString(isSaving.value ? '保存中...' : '下一步'), 1 /* TEXT */)\n                    ], 8 /* PROPS */, _hoisted_59)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DLCManagementPage.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DLCManagementPage.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DLCManagementPage.vue?vue&type=style&index=0&id=dc0e7d2c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.28_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-dc0e7d2c\"]])\n\nexport default __exports__","/**\n * 环境状态初始值\n */\nexport const initialEnvStatus = {\n  tavernHelper: {\n    version: null as string | null,\n    status: 'unknown',\n    statusText: '加载中...',\n  },\n  ejsTemplate: {\n    status: 'unknown',\n    statusText: '加载中...',\n    enabledStatus: 'unknown',\n    enabledText: '加载中...',\n  },\n  mvu: {\n    status: 'unknown',\n    statusText: '加载中...',\n  },\n  allOk: false,\n};\n\n/**\n * 版本比较工具\n * @returns 1 if v1 > v2, -1 if v1 < v2, 0 if equal\n */\nexport function compareVersion(v1: string | null, v2: string): number {\n  if (!v1 || !v2) return -1;\n  const s1 = String(v1);\n  const s2 = String(v2);\n  const arr1 = s1.split('.').map(Number);\n  const arr2 = s2.split('.').map(Number);\n  const len = Math.max(arr1.length, arr2.length);\n  for (let i = 0; i < len; i++) {\n    const num1 = arr1[i] || 0;\n    const num2 = arr2[i] || 0;\n    if (num1 > num2) return 1;\n    if (num1 < num2) return -1;\n  }\n  return 0;\n}\n//检查酒馆助手\nexport function checkTavernHelper() {\n  const version = getTavernHelperVersion();\n\n  if (!version) {\n    return {\n      version: null,\n      status: 'error',\n      statusText: '未找到',\n    };\n  }\n\n  const isVersionOk = compareVersion(version, '4.3.17') >= 0;\n\n  return {\n    version,\n    status: isVersionOk ? 'ok' : 'warn',\n    statusText: isVersionOk ? '正常' : '版本过低',\n  };\n}\n//检查ejs\nexport function checkEjsTemplate() {\n  try {\n    const context = window.top?.SillyTavern.getContext();\n    const ejsTemplateSettings = context.extensionSettings.EjsTemplate;\n\n    if (!ejsTemplateSettings) {\n      return {\n        status: 'error',\n        statusText: '未检测到',\n        enabled: false,\n        enabledStatus: 'unknown',\n        enabledText: '---',\n      };\n    }\n\n    return {\n      status: 'ok',\n      statusText: '存在',\n      enabled: ejsTemplateSettings.enabled,\n      enabledStatus: ejsTemplateSettings.enabled ? 'ok' : 'warn',\n      enabledText: ejsTemplateSettings.enabled ? '已启用' : '未启用',\n    };\n  } catch (e) {\n    return {\n      status: 'error',\n      statusText: '无法访问',\n      enabled: false,\n      enabledStatus: 'unknown',\n      enabledText: '---',\n    };\n  }\n}\n//检查mvu\nexport async function checkMvu() {\n  const timeoutDuration = 3000;\n  let timeoutId;\n\n  try {\n    const timeoutPromise = new Promise((_, reject) => {\n      timeoutId = setTimeout(() => {\n        reject(new Error('timed out'));\n      }, timeoutDuration);\n    });\n\n    await Promise.race([waitGlobalInitialized('Mvu'), timeoutPromise]);\n\n    clearTimeout(timeoutId);\n\n    return { status: 'ok', statusText: '正常' };\n  } catch (error) {\n    if (timeoutId) clearTimeout(timeoutId);\n    return { status: 'error', statusText: '异常/超时' };\n  }\n}\n//执行完整环境检查\nexport async function performFullEnvCheck() {\n  const tavernHelper = checkTavernHelper();\n  const ejsTemplate = checkEjsTemplate();\n  const mvu = await checkMvu();\n\n  const allOk =\n    tavernHelper.status === 'ok' &&\n    ejsTemplate.status === 'ok' &&\n    ejsTemplate.enabledStatus === 'ok' &&\n    mvu.status === 'ok';\n\n  return {\n    tavernHelper,\n    ejsTemplate,\n    mvu,\n    allOk,\n  };\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"env-check-page\" };\nconst _hoisted_2 = { class: \"env-check-container\" };\nconst _hoisted_3 = { class: \"env-check-item\" };\nconst _hoisted_4 = { class: \"env-check-details\" };\nconst _hoisted_5 = { class: \"env-check-item\" };\nconst _hoisted_6 = { class: \"env-check-details\" };\nconst _hoisted_7 = { class: \"env-check-item\" };\nconst _hoisted_8 = { class: \"env-check-details\" };\nconst _hoisted_9 = { class: \"recheck-container\" };\nconst _hoisted_10 = [\"disabled\"];\nconst _hoisted_11 = {\n    key: 0,\n    class: \"success-message\"\n};\nimport { onMounted, ref, watch } from 'vue';\nimport { initialEnvStatus, performFullEnvCheck } from '../services/envCheck';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'EnvCheckPage',\n    emits: ['next', 'envCheckComplete'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const isChecking = ref(false);\n        const envStatus = ref({ ...initialEnvStatus });\n        async function performCheck() {\n            isChecking.value = true;\n            try {\n                const result = await performFullEnvCheck();\n                envStatus.value = result;\n                emit('envCheckComplete', result);\n            }\n            catch (error) {\n                console.error('环境检查失败:', error);\n            }\n            finally {\n                isChecking.value = false;\n            }\n        }\n        // 监听环境检查状态，检查通过后自动跳转到下一页\n        watch(() => envStatus.value.allOk, allOk => {\n            if (allOk && !isChecking.value) {\n                emit('next');\n            }\n        });\n        onMounted(() => {\n            performCheck();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[9] || (_cache[9] = _createElementVNode(\"h2\", { class: \"main-title\" }, \"环境检查\", -1 /* CACHED */)),\n                _createCommentVNode(\" 环境检查部分 \"),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createCommentVNode(\" 酒馆助手 \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"env-check-label\" }, [\n                            _createElementVNode(\"span\", { class: \"icon\" }, \"⚙️\"),\n                            _createElementVNode(\"span\", null, \"酒馆助手\")\n                        ], -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _createElementVNode(\"span\", null, [\n                                _cache[0] || (_cache[0] = _createTextVNode(\"版本: \", -1 /* CACHED */)),\n                                _createElementVNode(\"strong\", {\n                                    class: _normalizeClass('status-' + (envStatus.value.tavernHelper.version ? 'ok' : 'unknown'))\n                                }, _toDisplayString(envStatus.value.tavernHelper.version || '未知'), 3 /* TEXT, CLASS */)\n                            ]),\n                            _createElementVNode(\"span\", null, [\n                                _cache[1] || (_cache[1] = _createTextVNode(\"状态: \", -1 /* CACHED */)),\n                                _createElementVNode(\"strong\", {\n                                    class: _normalizeClass('status-' + envStatus.value.tavernHelper.status)\n                                }, _toDisplayString(envStatus.value.tavernHelper.statusText), 3 /* TEXT, CLASS */)\n                            ])\n                        ])\n                    ]),\n                    _createCommentVNode(\" 提示词模板 (EJS) \"),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[5] || (_cache[5] = _createElementVNode(\"div\", { class: \"env-check-label\" }, [\n                            _createElementVNode(\"span\", { class: \"icon\" }, \"📄\"),\n                            _createElementVNode(\"span\", null, \"提示词模板 (EJS)\")\n                        ], -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _createElementVNode(\"span\", null, [\n                                _cache[3] || (_cache[3] = _createTextVNode(\"状态: \", -1 /* CACHED */)),\n                                _createElementVNode(\"strong\", {\n                                    class: _normalizeClass('status-' + envStatus.value.ejsTemplate.status)\n                                }, _toDisplayString(envStatus.value.ejsTemplate.statusText), 3 /* TEXT, CLASS */)\n                            ]),\n                            _createElementVNode(\"span\", null, [\n                                _cache[4] || (_cache[4] = _createTextVNode(\"启用?: \", -1 /* CACHED */)),\n                                _createElementVNode(\"strong\", {\n                                    class: _normalizeClass('status-' + envStatus.value.ejsTemplate.enabledStatus)\n                                }, _toDisplayString(envStatus.value.ejsTemplate.enabledText), 3 /* TEXT, CLASS */)\n                            ])\n                        ])\n                    ]),\n                    _createCommentVNode(\" MVU 框架 \"),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        _cache[7] || (_cache[7] = _createElementVNode(\"div\", { class: \"env-check-label\" }, [\n                            _createElementVNode(\"span\", { class: \"icon\" }, \"🧩\"),\n                            _createElementVNode(\"span\", null, \"MVU 框架\")\n                        ], -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_8, [\n                            _createElementVNode(\"span\", null, [\n                                _cache[6] || (_cache[6] = _createTextVNode(\"状态: \", -1 /* CACHED */)),\n                                _createElementVNode(\"strong\", {\n                                    class: _normalizeClass('status-' + envStatus.value.mvu.status)\n                                }, _toDisplayString(envStatus.value.mvu.statusText), 3 /* TEXT, CLASS */)\n                            ])\n                        ])\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        _createElementVNode(\"button\", {\n                            class: \"recheck-button\",\n                            disabled: isChecking.value,\n                            onClick: performCheck\n                        }, _toDisplayString(isChecking.value ? '检查中...' : '重新检查'), 9 /* TEXT, PROPS */, _hoisted_10)\n                    ])\n                ]),\n                _createCommentVNode(\" 检查通过提示 \"),\n                _createVNode(_Transition, { name: \"fade\" }, {\n                    default: _withCtx(() => [\n                        (envStatus.value.allOk && !isChecking.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [...(_cache[8] || (_cache[8] = [\n                                    _createElementVNode(\"span\", { class: \"success-icon\" }, \"✅\", -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"环境检查通过，正在跳转...\", -1 /* CACHED */)\n                                ]))]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _: 1 /* STABLE */\n                })\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./EnvCheckPage.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./EnvCheckPage.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./EnvCheckPage.vue?vue&type=style&index=0&id=1dbb7d39&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.28_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1dbb7d39\"]])\n\nexport default __exports__","import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, createStaticVNode as _createStaticVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"showcase-section\" }\nconst _hoisted_2 = { class: \"credits-container\" }\nconst _hoisted_3 = { class: \"author-badges\" }\nconst _hoisted_4 = { class: \"author-badges\" }\nconst _hoisted_5 = { class: \"credits-special\" }\n\n\nexport default {\n  __name: 'ShowcaseSection',\n  setup(__props) {\n\nconst teamMembers = [\n  '@𝕽𝖍𝖞𝖘_𝖟_瑞',\n  '@Yoyo514',\n  '@十七',\n  '@Hilo',\n  '@快乐柠萌茶',\n  '@三饺初华',\n  '@银时萝',\n  '@镜梦幻',\n  '@风见幽泠',\n  '@lili',\n  '@北游',\n  '@仰望星空',\n  '@K1nn',\n  '@随风渐变',\n  '@Aoo',\n  '@青砚',\n];\n\nconst hallOfFame = ['@Kitaikuyo', '@秋天的咸鱼'];\n\nconst specialThanks = ['@FL已放弃治疗', '@tongtny123', '@willing', '@肆祀一一', '@大乐'];\n\nreturn (_ctx, _cache) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createCommentVNode(\" 主标题 \"),\n    _cache[3] || (_cache[3] = _createElementVNode(\"h1\", { class: \"page-super-title\" }, \"命定之诗与黄昏之歌\", -1 /* CACHED */)),\n    _cache[4] || (_cache[4] = _createElementVNode(\"p\", { class: \"page-subtitle-english\" }, \"Destined Poetry & Twilight Song\", -1 /* CACHED */)),\n    _cache[5] || (_cache[5] = _createElementVNode(\"hr\", { class: \"ornamental-divider\" }, null, -1 /* CACHED */)),\n    _createCommentVNode(\" 制作人员展示区 \"),\n    _createElementVNode(\"div\", _hoisted_2, [\n      _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"credits-title\" }, \"❖ 制作团队 ❖\", -1 /* CACHED */)),\n      _createElementVNode(\"div\", _hoisted_3, [\n        (_openBlock(), _createElementBlock(_Fragment, null, _renderList(teamMembers, (author) => {\n          return _createElementVNode(\"span\", {\n            key: author,\n            class: \"author-badge\"\n          }, _toDisplayString(author), 1 /* TEXT */)\n        }), 64 /* STABLE_FRAGMENT */))\n      ]),\n      _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"credits-title\" }, \"❖ 英灵殿 ❖\", -1 /* CACHED */)),\n      _createElementVNode(\"div\", _hoisted_4, [\n        (_openBlock(), _createElementBlock(_Fragment, null, _renderList(hallOfFame, (author) => {\n          return _createElementVNode(\"span\", {\n            key: author,\n            class: \"author-badge\"\n          }, _toDisplayString(author), 1 /* TEXT */)\n        }), 64 /* STABLE_FRAGMENT */))\n      ]),\n      _createElementVNode(\"div\", _hoisted_5, [\n        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"特别鸣谢：\", -1 /* CACHED */)),\n        _createTextVNode(_toDisplayString(specialThanks.join(' ')), 1 /* TEXT */)\n      ])\n    ]),\n    _createCommentVNode(\" 合并后的信息面板 \"),\n    _cache[6] || (_cache[6] = _createStaticVNode(\"<details class=\\\"info-panel\\\" data-v-41312ea8><summary data-v-41312ea8><span data-v-41312ea8>世界背景与相关信息</span><span class=\\\"arrow-toggle\\\" data-v-41312ea8>❖</span></summary><div class=\\\"info-content\\\" data-v-41312ea8><h3 data-v-41312ea8>阿斯塔利亚世界</h3><p data-v-41312ea8> 小时候的你读过那样的故事吗？在剑与魔法的异世界中，幻想中的故事。一句澄澈而坚定的誓言，一段英雄的骑行，一页由凡人书写的史诗。 </p><div class=\\\"world-quote\\\" data-v-41312ea8>&quot;家园已在身后，世界尽在眼前。&quot;</div><div class=\\\"world-quote\\\" data-v-41312ea8> &quot;长夜将至，我从今开始守望，至死方休。我将不娶妻、不封地、不生子。我将不戴宝冠，不争荣宠。我将尽忠职守，生死于斯。我是黑暗中的利剑，长城上的守卫，抵御寒冷的烈焰，破晓时分的光线，唤醒眠者的号角，守护王国的坚盾。我将生命与荣耀献给守夜人，今夜如此，夜夜皆然。&quot; </div><div class=\\\"world-quote\\\" data-v-41312ea8> &quot;荣耀即吾命！&quot;<br data-v-41312ea8> &quot;愿黑松长青，愿号角长鸣，愿理想闪耀如初，愿长剑锋利如故。&quot; </div><p data-v-41312ea8> 这里是阿斯塔利亚。&quot;剑与魔法&quot;、&quot;诗与远方&quot;、&quot;历史与传说&quot;、&quot;生者与死者&quot;、&quot;英雄与史诗&quot;、&quot;神灵与命运&quot;的世界。 </p><p data-v-41312ea8>请拿起你梦中与儿时最浪漫的笔，亲自书写属于你自己的冒险故事吧。</p><div class=\\\"update-section\\\" data-v-41312ea8><h3 data-v-41312ea8>获取最新更新</h3><ul data-v-41312ea8><li data-v-41312ea8><a href=\\\"https://discord.com/channels/1134557553011998840/1422790367631380490\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" data-v-41312ea8>更新频道 *脑</a></li><li data-v-41312ea8><a href=\\\"https://discord.com/channels/1291925535324110879/1422794259056033832\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" data-v-41312ea8>更新频道 *程</a></li></ul></div></div></details>\", 1))\n  ]))\n}\n}\n\n}","/* unplugin-vue-components disabled */import script from \"./ShowcaseSection.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ShowcaseSection.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ShowcaseSection.vue?vue&type=style&index=0&id=41312ea8&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.28_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-41312ea8\"]])\n\nexport default __exports__","// ==================== 变量输出方式相关 ====================\n\nimport { getWorldBookName, updateWorldBook } from '@/home/services/worldbookload&update';\n\n// 固定的条目名称\nconst OUTPUT_ENTRY_MAIN_API = 'output_format (随AI输出开，主API)';\nconst OUTPUT_ENTRY_EXTRA_API = '[mvu_update]output_format (使用额外模型更新变量开)';\n\n// 变量输出方式选项\nexport const OUTPUT_OPTIONS = [\n  {\n    value: '主API',\n    label: '主API',\n    desc: '使用主API解析变量更新',\n    entryName: OUTPUT_ENTRY_MAIN_API,\n  },\n  {\n    value: '额外API',\n    label: '额外API',\n    desc: '使用额外API解析变量更新',\n    entryName: OUTPUT_ENTRY_EXTRA_API,\n  },\n];\n\n/**\n * 保存输出方式选择到世界书\n * @param selectedValue 选中的输出方式值（'主API' 或 '额外API'）\n */\nexport async function saveOutputSelection(selectedValue: string): Promise<void> {\n  const bookName = getWorldBookName();\n  if (!bookName) {\n    console.error('未找到世界书');\n    return;\n  }\n\n  // 根据选择构建更新条目\n  const updatedEntries = OUTPUT_OPTIONS.map(opt => ({\n    name: opt.entryName,\n    enabled: opt.value === selectedValue,\n  }));\n\n  await updateWorldBook(updatedEntries, bookName);\n}\n","/**\n * 场景列表配置\n */\nexport const scenarios = [\n  { index: 1, label: '我的故事将由我亲手书写(自定义)' },\n  { index: 2, label: '《来自异世界的\"勇者\"》' },\n  { index: 3, label: '《红月之誓（画饼占坑）》' },\n  { index: 4, label: '《线与天堂与彼岸花》' },\n  { index: 5, label: '《慈悲的\"魔王\"（画饼占坑）》' },\n];\n\n/**\n * 切换场景（Swipe）\n */\nexport async function switchSwipe(swipeId: number): Promise<boolean> {\n  if (typeof SillyTavern === 'undefined' || !SillyTavern.chat || SillyTavern.chat.length === 0) {\n    console.warn('SillyTavern environment not detected. Action will not be executed.');\n    return false;\n  }\n\n  const swipeIndex = swipeId;\n\n  if (\n    typeof SillyTavern.chat[0].swipe_id !== 'undefined' &&\n    SillyTavern.chat[0].swipe_id !== swipeIndex\n  ) {\n    if (SillyTavern.chat[0].swipes && SillyTavern.chat[0].swipes.length > swipeIndex) {\n      SillyTavern.chat[0].swipe_id = swipeIndex;\n      SillyTavern.chat[0].mes = SillyTavern.chat[0].swipes[swipeIndex];\n      await SillyTavern.saveChat();\n      await SillyTavern.reloadCurrentChat();\n      console.log(`Successfully switched to scenario (swipe_id: ${swipeIndex}).`);\n      return true;\n    } else {\n      console.error(`Swipe index ${swipeIndex} is out of bounds or swipes array is missing.`);\n      return false;\n    }\n  } else {\n    console.log(`Scenario ${swipeIndex} is already selected or swipe data is unavailable.`);\n    return true;\n  }\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"start-page\" };\nconst _hoisted_2 = { class: \"control-panel-container\" };\nconst _hoisted_3 = { class: \"scenario-list\" };\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"output-settings-container\" };\nconst _hoisted_6 = { class: \"control-group\" };\nconst _hoisted_7 = { class: \"control-buttons\" };\nconst _hoisted_8 = [\"onClick\"];\nconst _hoisted_9 = { class: \"button-desc\" };\nconst _hoisted_10 = { class: \"step-footer\" };\nconst _hoisted_11 = [\"disabled\"];\nimport { computed, ref } from 'vue';\nimport { OUTPUT_OPTIONS, saveOutputSelection } from '../services/outputMethod';\nimport { scenarios, switchSwipe } from '../services/StartPage';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'StartPage',\n    emits: ['prev'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const selectedIndex = ref(null);\n        const selectedOutput = ref('');\n        const isLoading = ref(false);\n        // 变量输出方式选项\n        const outputOptions = OUTPUT_OPTIONS;\n        // 判断是否可以进入下一步（需要同时选择场景和输出方式）\n        const canProceed = computed(() => {\n            return selectedIndex.value !== null && selectedOutput.value !== '';\n        });\n        function handleScenarioSelect(index) {\n            selectedIndex.value = index;\n        }\n        function selectOutput(value) {\n            selectedOutput.value = value;\n        }\n        /**\n         * 点击下一步：保存输出方式选择并切换场景\n         */\n        async function handleNext() {\n            if (!canProceed.value)\n                return;\n            isLoading.value = true;\n            try {\n                // 保存输出方式选择到世界书\n                await saveOutputSelection(selectedOutput.value);\n                // 切换到选中的场景\n                await switchSwipe(selectedIndex.value);\n            }\n            catch (error) {\n                console.error('保存设置失败:', error);\n            }\n            finally {\n                isLoading.value = false;\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[2] || (_cache[2] = _createElementVNode(\"h2\", { class: \"main-title\" }, \"你的故事将从何开始\", -1 /* CACHED */)),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"ul\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(scenarios), (scenario) => {\n                            return (_openBlock(), _createElementBlock(\"li\", {\n                                key: scenario.index\n                            }, [\n                                _createElementVNode(\"button\", {\n                                    class: _normalizeClass([\"scenario-option\", { selected: selectedIndex.value === scenario.index }]),\n                                    onClick: ($event) => (handleScenarioSelect(scenario.index))\n                                }, _toDisplayString(scenario.label), 11 /* TEXT, CLASS, PROPS */, _hoisted_4)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_5, [\n                    _createElementVNode(\"div\", _hoisted_6, [\n                        _createElementVNode(\"div\", _hoisted_7, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(outputOptions), (option) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: option.value,\n                                    class: \"control-item-wrapper\"\n                                }, [\n                                    _createElementVNode(\"button\", {\n                                        class: _normalizeClass([\"control-button\", { selected: selectedOutput.value === option.value }]),\n                                        onClick: ($event) => (selectOutput(option.value))\n                                    }, _toDisplayString(option.label), 11 /* TEXT, CLASS, PROPS */, _hoisted_8),\n                                    _createElementVNode(\"span\", _hoisted_9, _toDisplayString(option.desc), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_10, [\n                    _createElementVNode(\"button\", {\n                        class: \"nav-button\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('prev')))\n                    }, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"span\", null, \"上一步\", -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        class: \"nav-button\",\n                        disabled: !canProceed.value || isLoading.value,\n                        onClick: handleNext\n                    }, [\n                        _createElementVNode(\"span\", null, _toDisplayString(isLoading.value ? '保存中...' : '开始旅程'), 1 /* TEXT */)\n                    ], 8 /* PROPS */, _hoisted_11)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./StartPage.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./StartPage.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./StartPage.vue?vue&type=style&index=0&id=72407620&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.28_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-72407620\"]])\n\nexport default __exports__","import { createVNode as _createVNode, resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock, Transition as _Transition, withCtx as _withCtx, createElementVNode as _createElementVNode, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"selector-scroll\" }\nconst _hoisted_2 = { class: \"step-content\" }\n\nimport { provide, readonly, ref } from 'vue';\nimport CorePage from './components/CorePage.vue';\nimport DLCManagementPage from './components/DLCManagementPage.vue';\nimport EnvCheckPage from './components/EnvCheckPage.vue';\nimport ShowcaseSection from './components/ShowcaseSection.vue';\nimport StartPage from './components/StartPage.vue';\n\n\nexport default {\n  __name: 'App',\n  setup(__props) {\n\nconst currentStep = ref(0);\n\nconst steps = [EnvCheckPage, DLCManagementPage, CorePage, StartPage];\n\n// 环境检查结果\nconst envCheckResult = ref(null);\n\n// 提供给子组件使用\nprovide('envCheckResult', readonly(envCheckResult));\n\nfunction nextStep() {\n  if (currentStep.value < steps.length - 1) {\n    currentStep.value++;\n  }\n}\n\nfunction prevStep() {\n  if (currentStep.value > 0) {\n    currentStep.value--;\n  }\n}\n\nfunction handleEnvCheckComplete(result) {\n  envCheckResult.value = result;\n}\n\nreturn (_ctx, _cache) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(ShowcaseSection),\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createVNode(_Transition, {\n        name: \"fade\",\n        mode: \"out-in\"\n      }, {\n        default: _withCtx(() => [\n          (_openBlock(), _createBlock(_resolveDynamicComponent(steps[currentStep.value]), {\n            onNext: nextStep,\n            onPrev: prevStep,\n            onEnvCheckComplete: handleEnvCheckComplete\n          }, null, 32 /* NEED_HYDRATION */))\n        ]),\n        _: 1 /* STABLE */\n      })\n    ])\n  ]))\n}\n}\n\n}","/* unplugin-vue-components disabled */import script from \"./App.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=0af98a94&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.28_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0af98a94\"]])\n\nexport default __exports__","import { createApp } from 'vue';\nimport App from './App.vue';\nimport './assets/styles/global.css';\n\ncreateApp(App).mount('#app');\n"],"names":["exports","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","Vue","getWorldBookName","bookInfo","window","top","TavernHelper","getCharWorldbookNames","primary","async","getFilteredEntries","pattern","bookName","worldbook","getWorldbook","map","entry","name","enabled","getWorldbookEntries","length","filter","test","updateWorldBook","entries","Error","enabledMap","Map","e","updateWorldbookWith","newEnabled","get","undefined","UNCATEGORIZED_TAB","SPECIAL_RECOMMEND_TAB","CORE_PATTERN","AUTHOR_PATTERN","initialCoreState","coreOptions","localCoreSelections","tabs","activeTab","cachedRankings","cachedSpecialRecommendCores","DATA_BASE_PATH","getTabsFromRankings","Rankings","response","fetch","ok","console","log","text","data","error","loadCoreClassification","dynamicTabs","Object","keys","getCoreRanking","label","allTabs","matchedTabs","note","tabName","tabData","push","getSelectedCore","specialRecommendCores","specialRecommendCoreList","existingCoreValues","result","count","coreValue","config","nameWithoutPrefix","replace","authorMatch","match","author","value","specialNote","available","has","generateSpecialRecommendCores","Set","availableSpecialCores","core","ranking","coreTabs","unshift","recommendCore","find","c","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","__name","emits","setup","__props","emit","__emit","isLoading","ref","isSaving","tabStartIndex","selectedCore","computed","isSpecialRecommendTab","showArrows","visibleTabs","slice","handlePrevTabs","Math","max","handleNextTabs","min","getCoresForTab","tab","includes","loadCoreOptions","specialRecommendCoresData","loadSpecialRecommendCores","handleRefresh","handleSelectCore","newSelections","set","selectCore","handleNext","hasChanges","updatedEntries","Array","from","saveChanges","watch","newTab","tabIndex","indexOf","onMounted","_ctx","_cache","disabled","title","onClick","active","$event","unavailable","selected","$emit","__webpack_require__","moduleId","cachedModule","module","__webpack_modules__","pinyinCompare","a","b","localeCompare","sensitivity","CHARACTER_PATTERN","CHARACTER_NAME_PATTERN","initialCharacterState","characterOptions","localCharacterSelections","EVENT_PATTERN","EVENT_KEY_PATTERN","EVENT_LABEL_PATTERN","initialEventState","eventOptions","localEventSelections","EXTENSION_PATTERN","EXTENSION_KEY_PATTERN","EXTENSION_LABEL_PATTERN","EXTENSION_EXCLUSION_PATTERN","EXTENSION_REPLACEMENT_PATTERN","EXTENSION_PREREQUISITE_PATTERN","initialExtensionState","extensionOptions","localExtensionSelections","loadCharacterOptions","info","entryName","nameWithAuthor","authorInfo","trim","dashIndex","substring","parseCharacterName","sortedCharacterOptions","options","sort","char","extractEventKey","extractEventLabel","eventKey","extractEventAuthorInfo","loadEventOptions","eventGroups","groupEntries","allEnabled","every","sortedEventOptions","event","extractExtensionKey","extractExtensionLabel","extensionKey","extractExclusionTargetsFromEntry","targets","regex","RegExp","source","exec","extractReplacementTargetsFromEntry","extractPrerequisiteTargetsFromEntry","extractExtensionExclusionTargets","allTargets","forEach","t","add","extractExtensionReplacementTargets","extractExtensionPrerequisiteTargets","extractExtensionAuthorInfo","loadExtensionOptions","extensionGroups","exclusionTargets","replacementTargets","prerequisiteTargets","sortedExtensionOptions","ext","saveExtensionChanges","hasExtensionChanges","originalExtensionStates","exclusionTargetsToDisable","collectExclusionTargetsToDisable","replacementTargetsToDisable","collectReplacementTargetsToDisable","replacementTargetsToEnable","isEnabled","wasEnabled","collectReplacementTargetsToEnable","filteredReplacementTargetsToEnable","escapeRegExp","matchingEntries","existingIndex","findIndex","string","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","selectedCharacter","selectedEvent","selectedExtension","getSelectedCharacterInfo","getSelectedEventInfo","getSelectedExtensionInfo","loadAllOptions","charResult","eventResult","extResult","Promise","all","handleToggleCharacter","characterValue","currentEnabled","toggleCharacter","handleToggleEvent","toggleEvent","handleToggleExtension","targetExtension","satisfied","missingPrerequisites","prerequisiteExtension","checkPrerequisites","selections","success","join","exclusionTarget","toggleExtension","alert","updatedCharacters","hasCharacterChanges","saveCharacterChanges","updatedEvents","hasEventChanges","saveEventChanges","updatedExtensions","initialEnvStatus","tavernHelper","version","status","statusText","ejsTemplate","enabledStatus","enabledText","mvu","allOk","checkTavernHelper","getTavernHelperVersion","isVersionOk","v1","v2","s1","String","s2","arr1","split","Number","arr2","len","i","num1","num2","compareVersion","performFullEnvCheck","context","SillyTavern","getContext","ejsTemplateSettings","extensionSettings","EjsTemplate","checkEjsTemplate","timeoutId","timeoutPromise","_","reject","setTimeout","race","waitGlobalInitialized","clearTimeout","checkMvu","isChecking","envStatus","performCheck","default","teamMembers","hallOfFame","specialThanks","OUTPUT_OPTIONS","desc","scenarios","index","selectedIndex","selectedOutput","outputOptions","canProceed","selectedValue","opt","saveOutputSelection","swipeId","chat","warn","swipeIndex","swipe_id","swipes","mes","saveChat","reloadCurrentChat","switchSwipe","scenario","option","currentStep","steps","EnvCheckPage","DLCManagementPage","CorePage","StartPage","envCheckResult","nextStep","prevStep","handleEnvCheckComplete","provide","readonly","ShowcaseSection","mode","onNext","onPrev","onEnvCheckComplete","createApp","App","mount"],"sourceRoot":""}